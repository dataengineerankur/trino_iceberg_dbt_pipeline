{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.3", "generated_at": "2025-03-18T17:21:57.256185Z", "invocation_id": "9a7d3066-c132-4923-923a-d871d1424563", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-03-18T17:21:55.972429Z", "completed_at": "2025-03-18T17:21:56.160667Z"}, {"name": "execute", "started_at": "2025-03-18T17:21:56.160946Z", "completed_at": "2025-03-18T17:21:57.251852Z"}], "thread_id": "Thread-1", "execution_time": 1.2805812358856201, "adapter_response": {"_message": "MERGE (4 rows)", "rows_affected": 4, "query_id": "20250318_050542_00097_j25rb", "query": "-- back compat for old kwarg name\n  \n  \n        \n            \n            \n        \n\n        \n\n        merge into \"iceberg\".\"default\".\"events_streaming\" as DBT_INTERNAL_DEST\n            using \"iceberg\".\"default\".\"events_streaming__dbt_tmp\" as DBT_INTERNAL_SOURCE\n            on (\n                DBT_INTERNAL_SOURCE.id = DBT_INTERNAL_DEST.id\n            )\n\n        \n        when matched then update set\n            \"id\" = DBT_INTERNAL_SOURCE.\"id\",\"name\" = DBT_INTERNAL_SOURCE.\"name\",\"created_at\" = DBT_INTERNAL_SOURCE.\"created_at\",\"_partition_id\" = DBT_INTERNAL_SOURCE.\"_partition_id\",\"_partition_offset\" = DBT_INTERNAL_SOURCE.\"_partition_offset\",\"processed_at\" = DBT_INTERNAL_SOURCE.\"processed_at\"\n        \n\n        when not matched then insert\n            (\"id\", \"name\", \"created_at\", \"_partition_id\", \"_partition_offset\", \"processed_at\")\n        values\n            (DBT_INTERNAL_SOURCE.\"id\", DBT_INTERNAL_SOURCE.\"name\", DBT_INTERNAL_SOURCE.\"created_at\", DBT_INTERNAL_SOURCE.\"_partition_id\", DBT_INTERNAL_SOURCE.\"_partition_offset\", DBT_INTERNAL_SOURCE.\"processed_at\")\n/* dbt: dev */"}, "message": "MERGE (4 rows)", "failures": null, "unique_id": "model.iceberg_project.events_streaming", "compiled": true, "compiled_code": "\n\n\n\n\n\n\n\n    \n\n\nWITH kafka_data AS (\n    SELECT\n        CAST(JSON_EXTRACT_SCALAR(CAST(_message AS VARCHAR), '$.id') AS BIGINT) AS id,\n        JSON_EXTRACT_SCALAR(CAST(_message AS VARCHAR), '$.name') AS name,\n        CAST(JSON_EXTRACT_SCALAR(CAST(_message AS VARCHAR), '$.created_at') AS TIMESTAMP(6)) AS created_at,\n        _partition_id,\n        _partition_offset\n    FROM \"kafka\".\"default\".\"events_topic\"\n    \n    WHERE _partition_offset > 6\n    \n)\n\nSELECT\n    id,\n    name,\n    created_at,\n    _partition_id,\n    _partition_offset,\n    CAST(CURRENT_TIMESTAMP AS TIMESTAMP(6)) AS processed_at\nFROM kafka_data\nWHERE id IS NOT NULL", "relation_name": "\"iceberg\".\"default\".\"events_streaming\"", "batch_results": null}], "elapsed_time": 1.6827399730682373, "args": {"log_level": "info", "strict_mode": false, "macro_debugging": false, "require_batched_execution_for_custom_microbatch_strategy": false, "use_colors": true, "send_anonymous_usage_stats": true, "warn_error_options": {"include": [], "exclude": []}, "exclude": [], "populate_cache": true, "print": true, "log_level_file": "debug", "log_path": "/Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/logs", "cache_selected_only": false, "favor_state": false, "partial_parse": true, "require_explicit_package_overrides_for_builtin_materializations": true, "empty": false, "profiles_dir": "/Users/ankurchopra/.dbt", "state_modified_compare_more_unrendered_values": false, "require_nested_cumulative_type_params": false, "partial_parse_file_diff": true, "source_freshness_run_project_hooks": false, "require_yaml_configuration_for_mf_time_spines": false, "version_check": true, "project_dir": "/Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project", "static_parser": true, "state_modified_compare_vars": false, "use_colors_file": true, "write_json": true, "log_file_max_bytes": 10485760, "log_format": "default", "vars": {}, "printer_width": 80, "skip_nodes_if_on_run_start_fails": false, "require_resource_names_without_spaces": false, "select": ["kafka_to_iceberg.events_streaming"], "show_resource_report": false, "which": "run", "introspect": true, "defer": false, "indirect_selection": "eager", "invocation_command": "dbt run --models kafka_to_iceberg.events_streaming", "log_format_file": "debug", "quiet": false}}