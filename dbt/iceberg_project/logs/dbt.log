[0m22:03:50.456623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105deb6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e91760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e91ee0>]}


============================== 22:03:50.459272 | 0387035d-f9fe-4e22-946c-72c9d6cf8998 ==============================
[0m22:03:50.459272 [info ] [MainThread]: Running with dbt=1.9.3
[0m22:03:50.459683 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'iceberg_project/logs', 'profiles_dir': '/Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models kafka_to_iceberg.events_streaming --project-dir iceberg_project', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:03:50.624642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0387035d-f9fe-4e22-946c-72c9d6cf8998', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10724cca0>]}
[0m22:03:50.668918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0387035d-f9fe-4e22-946c-72c9d6cf8998', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e5e040>]}
[0m22:03:50.669444 [info ] [MainThread]: Registered adapter: trino=1.9.0
[0m22:03:50.754836 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m22:03:50.755362 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m22:03:50.755614 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '0387035d-f9fe-4e22-946c-72c9d6cf8998', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1074cee20>]}
[0m22:03:51.685544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0387035d-f9fe-4e22-946c-72c9d6cf8998', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b1dfd0>]}
[0m22:03:51.756852 [debug] [MainThread]: Wrote artifact WritableManifest to iceberg_project/target/manifest.json
[0m22:03:51.758103 [debug] [MainThread]: Wrote artifact SemanticManifest to iceberg_project/target/semantic_manifest.json
[0m22:03:51.763887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0387035d-f9fe-4e22-946c-72c9d6cf8998', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b37670>]}
[0m22:03:51.764215 [info ] [MainThread]: Found 2 models, 3 data tests, 1 source, 456 macros
[0m22:03:51.764425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0387035d-f9fe-4e22-946c-72c9d6cf8998', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b18580>]}
[0m22:03:51.765074 [info ] [MainThread]: 
[0m22:03:51.765283 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:03:51.765449 [info ] [MainThread]: 
[0m22:03:51.765727 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m22:03:51.766190 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
[0m22:03:51.838504 [debug] [ThreadPool]: Using trino connection "list_iceberg"
[0m22:03:51.838868 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "iceberg_project", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
[0m22:03:51.839092 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:03:51.839270 [warn ] [ThreadPool]: [[33mWARNING[0m]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.
You may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.
Visit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.
[0m22:03:51.839548 [debug] [ThreadPool]: Sending event: {'category': 'dbt', 'action': 'BehaviorChangeEvent', 'label': '0387035d-f9fe-4e22-946c-72c9d6cf8998', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102de86d0>]}
[0m22:03:52.091671 [debug] [ThreadPool]: SQL status: SUCCESS in 0.253 seconds
[0m22:03:52.092541 [debug] [ThreadPool]: On list_iceberg: Close
[0m22:03:52.095846 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_default)
[0m22:03:52.106191 [debug] [ThreadPool]: Using trino connection "list_iceberg_default"
[0m22:03:52.106555 [debug] [ThreadPool]: On list_iceberg_default: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "iceberg_project", "target_name": "dev", "connection_name": "list_iceberg_default"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'default') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'default'
[0m22:03:52.106901 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:04:33.861264 [debug] [ThreadPool]: Trino adapter: Trino query id: 20250317_234927_00132_egrtd
[0m22:04:33.862762 [debug] [ThreadPool]: Trino adapter: Trino error: TrinoExternalError(type=EXTERNAL, name=HIVE_METASTORE_ERROR, message="172.20.0.2:9083: java.net.SocketTimeoutException: Read timed out", query_id=20250317_234927_00132_egrtd)
[0m22:04:33.863696 [debug] [ThreadPool]: On list_iceberg_default: ROLLBACK
[0m22:04:33.863942 [debug] [ThreadPool]: On list_iceberg_default: Close
[0m22:04:33.865263 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:04:33.865543 [debug] [MainThread]: Connection 'list_iceberg_default' was properly closed.
[0m22:04:33.865848 [info ] [MainThread]: 
[0m22:04:33.866693 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 42.10 seconds (42.10s).
[0m22:04:33.867545 [error] [MainThread]: Encountered an error:
Database Error
  TrinoExternalError(type=EXTERNAL, name=HIVE_METASTORE_ERROR, message="172.20.0.2:9083: java.net.SocketTimeoutException: Read timed out", query_id=20250317_234927_00132_egrtd)
[0m22:04:33.870329 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 43.467957, "process_in_blocks": "0", "process_kernel_time": 0.23754, "process_mem_max_rss": "131727360", "process_out_blocks": "0", "process_user_time": 2.234076}
[0m22:04:33.871080 [debug] [MainThread]: Command `dbt run` failed at 22:04:33.870981 after 43.47 seconds
[0m22:04:33.871564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105deb6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111b53910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ae3b50>]}
[0m22:04:33.872005 [debug] [MainThread]: Flushing usage events
[0m22:04:34.030207 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:08:08.400087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11002d5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117a3520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117a3fa0>]}


============================== 22:08:08.402920 | 72a196b5-e98d-4032-9ac5-f8a5b7a92b8d ==============================
[0m22:08:08.402920 [info ] [MainThread]: Running with dbt=1.9.3
[0m22:08:08.403314 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/logs', 'profiles_dir': '/Users/ankurchopra/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --models kafka_to_iceberg.events_streaming', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:08:08.405395 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'iceberg_project'
[0m22:08:08.406618 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.060223293, "process_in_blocks": "0", "process_kernel_time": 0.112871, "process_mem_max_rss": "95830016", "process_out_blocks": "0", "process_user_time": 0.76842}
[0m22:08:08.406962 [debug] [MainThread]: Command `dbt run` failed at 22:08:08.406904 after 0.06 seconds
[0m22:08:08.407175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11002d5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111140160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11172f130>]}
[0m22:08:08.407392 [debug] [MainThread]: Flushing usage events
[0m22:08:08.612787 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m22:11:47.278688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10750d610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083bf640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083bf160>]}


============================== 22:11:47.281456 | fb186d43-a537-4af8-8669-d766128da2bb ==============================
[0m22:11:47.281456 [info ] [MainThread]: Running with dbt=1.9.3
[0m22:11:47.281833 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/logs', 'profiles_dir': '/Users/ankurchopra/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --models kafka_to_iceberg.events_streaming', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:11:47.283874 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'iceberg_project'
[0m22:11:47.285099 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.05845904, "process_in_blocks": "0", "process_kernel_time": 0.106942, "process_mem_max_rss": "94486528", "process_out_blocks": "0", "process_user_time": 0.76694}
[0m22:11:47.285466 [debug] [MainThread]: Command `dbt run` failed at 22:11:47.285409 after 0.06 seconds
[0m22:11:47.285721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10750d610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1081fc880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e0a4c0>]}
[0m22:11:47.285971 [debug] [MainThread]: Flushing usage events
[0m22:11:47.411472 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:04:38.713501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c05640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ab7700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ab70d0>]}


============================== 23:04:38.716669 | d8ae3858-b172-4352-8a2c-8b36d52c6b56 ==============================
[0m23:04:38.716669 [info ] [MainThread]: Running with dbt=1.9.3
[0m23:04:38.717090 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/ankurchopra/.dbt', 'log_path': '/Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --models kafka_to_iceberg.events_streaming', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:04:38.907791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd8ae3858-b172-4352-8a2c-8b36d52c6b56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d51f70>]}
[0m23:04:38.951261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd8ae3858-b172-4352-8a2c-8b36d52c6b56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e33be0>]}
[0m23:04:38.951718 [info ] [MainThread]: Registered adapter: trino=1.9.0
[0m23:04:39.021532 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m23:04:39.120141 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:04:39.120429 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:04:39.156121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd8ae3858-b172-4352-8a2c-8b36d52c6b56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107386130>]}
[0m23:04:39.225457 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/target/manifest.json
[0m23:04:39.226737 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/target/semantic_manifest.json
[0m23:04:39.232525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd8ae3858-b172-4352-8a2c-8b36d52c6b56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107388760>]}
[0m23:04:39.232866 [info ] [MainThread]: Found 2 models, 3 data tests, 1 source, 456 macros
[0m23:04:39.233081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd8ae3858-b172-4352-8a2c-8b36d52c6b56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e2e9a0>]}
[0m23:04:39.233807 [info ] [MainThread]: 
[0m23:04:39.234028 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:04:39.234203 [info ] [MainThread]: 
[0m23:04:39.234496 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m23:04:39.234991 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
[0m23:04:39.269832 [debug] [ThreadPool]: Using trino connection "list_iceberg"
[0m23:04:39.270120 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "iceberg_project", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
[0m23:04:39.270325 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:04:39.270503 [warn ] [ThreadPool]: [[33mWARNING[0m]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.
You may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.
Visit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.
[0m23:04:39.270796 [debug] [ThreadPool]: Sending event: {'category': 'dbt', 'action': 'BehaviorChangeEvent', 'label': 'd8ae3858-b172-4352-8a2c-8b36d52c6b56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10775eb80>]}
[0m23:04:39.489841 [debug] [ThreadPool]: SQL status: SUCCESS in 0.219 seconds
[0m23:04:39.490768 [debug] [ThreadPool]: On list_iceberg: Close
[0m23:04:39.494208 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_default)
[0m23:04:39.536524 [debug] [ThreadPool]: Using trino connection "list_iceberg_default"
[0m23:04:39.536927 [debug] [ThreadPool]: On list_iceberg_default: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "iceberg_project", "target_name": "dev", "connection_name": "list_iceberg_default"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'default') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'default'
[0m23:04:39.537149 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:05:20.853481 [debug] [ThreadPool]: Trino adapter: Trino query id: 20250318_000810_00001_egrtd
[0m23:05:20.855194 [debug] [ThreadPool]: Trino adapter: Trino error: TrinoExternalError(type=EXTERNAL, name=HIVE_METASTORE_ERROR, message="172.20.0.2:9083: java.net.SocketTimeoutException: Read timed out", query_id=20250318_000810_00001_egrtd)
[0m23:05:20.856431 [debug] [ThreadPool]: On list_iceberg_default: ROLLBACK
[0m23:05:20.856711 [debug] [ThreadPool]: On list_iceberg_default: Close
[0m23:05:20.858026 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:05:20.858278 [debug] [MainThread]: Connection 'list_iceberg_default' was properly closed.
[0m23:05:20.858645 [info ] [MainThread]: 
[0m23:05:20.859064 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 41.62 seconds (41.62s).
[0m23:05:20.860572 [error] [MainThread]: Encountered an error:
Database Error
  TrinoExternalError(type=EXTERNAL, name=HIVE_METASTORE_ERROR, message="172.20.0.2:9083: java.net.SocketTimeoutException: Read timed out", query_id=20250318_000810_00001_egrtd)
[0m23:05:20.870610 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 42.21064, "process_in_blocks": "0", "process_kernel_time": 0.230479, "process_mem_max_rss": "117850112", "process_out_blocks": "0", "process_user_time": 1.448855}
[0m23:05:20.873525 [debug] [MainThread]: Command `dbt run` failed at 23:05:20.873096 after 42.21 seconds
[0m23:05:20.876098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c05640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e2dd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e2daf0>]}
[0m23:05:20.877911 [debug] [MainThread]: Flushing usage events
[0m23:05:21.018095 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:09:38.400484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051955b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106047520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106047fa0>]}


============================== 23:09:38.403359 | e3c176dd-cd6a-4074-bc72-ab1106672a0f ==============================
[0m23:09:38.403359 [info ] [MainThread]: Running with dbt=1.9.3
[0m23:09:38.403741 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/logs', 'version_check': 'True', 'profiles_dir': '/Users/ankurchopra/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --models kafka_to_iceberg.events_streaming', 'send_anonymous_usage_stats': 'True'}
[0m23:09:38.599905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e3c176dd-cd6a-4074-bc72-ab1106672a0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10630e6a0>]}
[0m23:09:38.644878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e3c176dd-cd6a-4074-bc72-ab1106672a0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10622b850>]}
[0m23:09:38.645353 [info ] [MainThread]: Registered adapter: trino=1.9.0
[0m23:09:38.718732 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m23:09:38.818924 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:09:38.819381 [debug] [MainThread]: Partial parsing: updated file: iceberg_project://models/kafka_to_iceberg/events_streaming.sql
[0m23:09:39.165500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e3c176dd-cd6a-4074-bc72-ab1106672a0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a1ef40>]}
[0m23:09:39.235041 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/target/manifest.json
[0m23:09:39.236661 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/target/semantic_manifest.json
[0m23:09:39.242931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e3c176dd-cd6a-4074-bc72-ab1106672a0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105aa2be0>]}
[0m23:09:39.243243 [info ] [MainThread]: Found 2 models, 3 data tests, 1 source, 456 macros
[0m23:09:39.243464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3c176dd-cd6a-4074-bc72-ab1106672a0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067c99d0>]}
[0m23:09:39.244160 [info ] [MainThread]: 
[0m23:09:39.244396 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:09:39.244575 [info ] [MainThread]: 
[0m23:09:39.244861 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m23:09:39.245352 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
[0m23:09:39.279543 [debug] [ThreadPool]: Using trino connection "list_iceberg"
[0m23:09:39.279836 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "iceberg_project", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
[0m23:09:39.280018 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:09:39.280181 [warn ] [ThreadPool]: [[33mWARNING[0m]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.
You may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.
Visit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.
[0m23:09:39.280442 [debug] [ThreadPool]: Sending event: {'category': 'dbt', 'action': 'BehaviorChangeEvent', 'label': 'e3c176dd-cd6a-4074-bc72-ab1106672a0f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a9b340>]}
[0m23:09:39.439361 [debug] [ThreadPool]: SQL status: SUCCESS in 0.159 seconds
[0m23:09:39.440291 [debug] [ThreadPool]: On list_iceberg: Close
[0m23:09:39.443636 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_default)
[0m23:09:39.454150 [debug] [ThreadPool]: Using trino connection "list_iceberg_default"
[0m23:09:39.454573 [debug] [ThreadPool]: On list_iceberg_default: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "iceberg_project", "target_name": "dev", "connection_name": "list_iceberg_default"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'default') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'default'
[0m23:09:39.454824 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:10:20.789627 [debug] [ThreadPool]: Trino adapter: Trino query id: 20250318_001310_00003_egrtd
[0m23:10:20.801790 [debug] [ThreadPool]: Trino adapter: Trino error: TrinoExternalError(type=EXTERNAL, name=HIVE_METASTORE_ERROR, message="172.20.0.2:9083: java.net.SocketTimeoutException: Read timed out", query_id=20250318_001310_00003_egrtd)
[0m23:10:20.802712 [debug] [ThreadPool]: On list_iceberg_default: ROLLBACK
[0m23:10:20.802937 [debug] [ThreadPool]: On list_iceberg_default: Close
[0m23:10:20.804040 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:10:20.804302 [debug] [MainThread]: Connection 'list_iceberg_default' was properly closed.
[0m23:10:20.804637 [info ] [MainThread]: 
[0m23:10:20.804951 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 41.56 seconds (41.56s).
[0m23:10:20.805898 [error] [MainThread]: Encountered an error:
Database Error
  TrinoExternalError(type=EXTERNAL, name=HIVE_METASTORE_ERROR, message="172.20.0.2:9083: java.net.SocketTimeoutException: Read timed out", query_id=20250318_001310_00003_egrtd)
[0m23:10:20.808859 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 42.463146, "process_in_blocks": "0", "process_kernel_time": 0.23083, "process_mem_max_rss": "124076032", "process_out_blocks": "0", "process_user_time": 1.731117}
[0m23:10:20.809637 [debug] [MainThread]: Command `dbt run` failed at 23:10:20.809532 after 42.46 seconds
[0m23:10:20.810184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051955b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067c9ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f39790>]}
[0m23:10:20.810590 [debug] [MainThread]: Flushing usage events
[0m23:10:20.997369 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:13:47.562947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d9d5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113663520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113663fa0>]}


============================== 23:13:47.565836 | ce54bc0a-f87c-46a3-a919-23f06f7fb473 ==============================
[0m23:13:47.565836 [info ] [MainThread]: Running with dbt=1.9.3
[0m23:13:47.566258 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ankurchopra/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --models diagnostic', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:13:47.758909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ce54bc0a-f87c-46a3-a919-23f06f7fb473', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11028d2e0>]}
[0m23:13:47.805702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ce54bc0a-f87c-46a3-a919-23f06f7fb473', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113b7f400>]}
[0m23:13:47.806339 [info ] [MainThread]: Registered adapter: trino=1.9.0
[0m23:13:47.877228 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m23:13:47.978548 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 1 files changed.
[0m23:13:47.978928 [debug] [MainThread]: Partial parsing: added file: iceberg_project://models/hive_metadata.sql
[0m23:13:47.979136 [debug] [MainThread]: Partial parsing: added file: iceberg_project://models/diagnostic.sql
[0m23:13:47.979398 [debug] [MainThread]: Partial parsing: updated file: iceberg_project://models/kafka_to_iceberg/events_streaming.sql
[0m23:13:48.330639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ce54bc0a-f87c-46a3-a919-23f06f7fb473', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1151d99a0>]}
[0m23:13:48.399147 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/target/manifest.json
[0m23:13:48.400979 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/target/semantic_manifest.json
[0m23:13:48.408492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ce54bc0a-f87c-46a3-a919-23f06f7fb473', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1154eaf10>]}
[0m23:13:48.408816 [info ] [MainThread]: Found 4 models, 3 data tests, 1 source, 456 macros
[0m23:13:48.409035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce54bc0a-f87c-46a3-a919-23f06f7fb473', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115298f40>]}
[0m23:13:48.409732 [info ] [MainThread]: 
[0m23:13:48.409946 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:13:48.410127 [info ] [MainThread]: 
[0m23:13:48.410421 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m23:13:48.410907 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
[0m23:13:48.442644 [debug] [ThreadPool]: Using trino connection "list_iceberg"
[0m23:13:48.442939 [debug] [ThreadPool]: On list_iceberg: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "iceberg_project", "target_name": "dev", "connection_name": "list_iceberg"} */

    select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
[0m23:13:48.443129 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:13:48.443311 [warn ] [ThreadPool]: [[33mWARNING[0m]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.
You may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.
Visit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.
[0m23:13:48.443604 [debug] [ThreadPool]: Sending event: {'category': 'dbt', 'action': 'BehaviorChangeEvent', 'label': 'ce54bc0a-f87c-46a3-a919-23f06f7fb473', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115914f70>]}
[0m23:13:48.590536 [debug] [ThreadPool]: SQL status: SUCCESS in 0.147 seconds
[0m23:13:48.591688 [debug] [ThreadPool]: On list_iceberg: Close
[0m23:13:48.595605 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_default)
[0m23:13:48.605869 [debug] [ThreadPool]: Using trino connection "list_iceberg_default"
[0m23:13:48.606187 [debug] [ThreadPool]: On list_iceberg_default: /* {"app": "dbt", "dbt_version": "1.9.3", "profile_name": "iceberg_project", "target_name": "dev", "connection_name": "list_iceberg_default"} */
select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'default') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'default'
[0m23:13:48.606428 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:14:29.950173 [debug] [ThreadPool]: Trino adapter: Trino query id: 20250318_001719_00005_egrtd
[0m23:14:29.955820 [debug] [ThreadPool]: Trino adapter: Trino error: TrinoExternalError(type=EXTERNAL, name=HIVE_METASTORE_ERROR, message="172.20.0.2:9083: java.net.SocketTimeoutException: Read timed out", query_id=20250318_001719_00005_egrtd)
[0m23:14:29.957764 [debug] [ThreadPool]: On list_iceberg_default: ROLLBACK
[0m23:14:29.958246 [debug] [ThreadPool]: On list_iceberg_default: Close
[0m23:14:29.961545 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:14:29.961786 [debug] [MainThread]: Connection 'list_iceberg_default' was properly closed.
[0m23:14:29.962744 [info ] [MainThread]: 
[0m23:14:29.963491 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 41.55 seconds (41.55s).
[0m23:14:29.970454 [error] [MainThread]: Encountered an error:
Database Error
  TrinoExternalError(type=EXTERNAL, name=HIVE_METASTORE_ERROR, message="172.20.0.2:9083: java.net.SocketTimeoutException: Read timed out", query_id=20250318_001719_00005_egrtd)
[0m23:14:29.973667 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 42.431114, "process_in_blocks": "0", "process_kernel_time": 0.227116, "process_mem_max_rss": "124125184", "process_out_blocks": "0", "process_user_time": 1.686915}
[0m23:14:29.974323 [debug] [MainThread]: Command `dbt run` failed at 23:14:29.974237 after 42.43 seconds
[0m23:14:29.974786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d9d5b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113b79160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115a7ba30>]}
[0m23:14:29.975181 [debug] [MainThread]: Flushing usage events
[0m23:14:30.116765 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:23:18.933419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058d15e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106783640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106783130>]}


============================== 23:23:18.936361 | dc314280-feaf-4de8-8e74-c99f2a964d8c ==============================
[0m23:23:18.936361 [info ] [MainThread]: Running with dbt=1.9.3
[0m23:23:18.936783 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'False', 'version_check': 'True', 'profiles_dir': '/Users/ankurchopra/.dbt', 'log_path': '/Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --models kafka_to_iceberg.events_streaming', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:23:18.993109 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "iceberg_project", target "dev" invalid: Runtime Error
    Got duplicate keys: (catalog) all map to "database"
[0m23:23:18.994564 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.114268, "process_in_blocks": "0", "process_kernel_time": 0.122858, "process_mem_max_rss": "96534528", "process_out_blocks": "0", "process_user_time": 0.808596}
[0m23:23:18.994907 [debug] [MainThread]: Command `dbt run` failed at 23:23:18.994852 after 0.11 seconds
[0m23:23:18.995140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058d15e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067cf220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067cf1f0>]}
[0m23:23:18.995371 [debug] [MainThread]: Flushing usage events
[0m23:23:19.146441 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:24:25.400172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067dd610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1188a3640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1188a3160>]}


============================== 23:24:25.403195 | 1ce43176-25bc-4ae0-9a91-6eb9cfd18ec7 ==============================
[0m23:24:25.403195 [info ] [MainThread]: Running with dbt=1.9.3
[0m23:24:25.403585 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'False', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/logs', 'version_check': 'True', 'profiles_dir': '/Users/ankurchopra/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run --models kafka_to_iceberg.events_streaming', 'send_anonymous_usage_stats': 'True'}
[0m23:24:25.596264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1ce43176-25bc-4ae0-9a91-6eb9cfd18ec7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bcd2e0>]}
[0m23:24:25.641410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1ce43176-25bc-4ae0-9a91-6eb9cfd18ec7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b7b6d0>]}
[0m23:24:25.641910 [info ] [MainThread]: Registered adapter: trino=1.8.5
[0m23:24:25.711088 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m23:24:25.789348 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m23:24:25.789757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1ce43176-25bc-4ae0-9a91-6eb9cfd18ec7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a3c370>]}
[0m23:24:26.683675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1ce43176-25bc-4ae0-9a91-6eb9cfd18ec7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1196caa30>]}
[0m23:24:26.792467 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/target/manifest.json
[0m23:24:26.793773 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/target/semantic_manifest.json
[0m23:24:26.800068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1ce43176-25bc-4ae0-9a91-6eb9cfd18ec7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1196c49a0>]}
[0m23:24:26.800390 [info ] [MainThread]: Found 4 models, 3 data tests, 1 source, 456 macros
[0m23:24:26.800607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ce43176-25bc-4ae0-9a91-6eb9cfd18ec7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1196cc1f0>]}
[0m23:24:26.801276 [info ] [MainThread]: 
[0m23:24:26.801482 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:24:26.801655 [info ] [MainThread]: 
[0m23:24:26.801910 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m23:24:26.802365 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
[0m23:24:26.833758 [debug] [ThreadPool]: Using trino connection "list_iceberg"
[0m23:24:26.834043 [debug] [ThreadPool]: On list_iceberg: select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
/* dbt: dev */
[0m23:24:26.834223 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:24:26.834383 [warn ] [ThreadPool]: [[33mWARNING[0m]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.
You may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.
Visit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.
[0m23:24:26.834644 [debug] [ThreadPool]: Sending event: {'category': 'dbt', 'action': 'BehaviorChangeEvent', 'label': '1ce43176-25bc-4ae0-9a91-6eb9cfd18ec7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1193ccdf0>]}
[0m23:24:27.027546 [debug] [ThreadPool]: SQL status: SUCCESS in 0.193 seconds
[0m23:24:27.028524 [debug] [ThreadPool]: On list_iceberg: Close
[0m23:24:27.032488 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_default)
[0m23:24:27.043206 [debug] [ThreadPool]: Using trino connection "list_iceberg_default"
[0m23:24:27.043607 [debug] [ThreadPool]: On list_iceberg_default: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'default') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'default'
/* dbt: dev */
[0m23:24:27.043826 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:25:08.302023 [debug] [ThreadPool]: Trino adapter: Trino query id: 20250318_002757_00007_egrtd
[0m23:25:08.302752 [debug] [ThreadPool]: Trino adapter: Trino error: TrinoExternalError(type=EXTERNAL, name=HIVE_METASTORE_ERROR, message="172.20.0.2:9083: java.net.SocketTimeoutException: Read timed out", query_id=20250318_002757_00007_egrtd)
[0m23:25:08.303234 [debug] [ThreadPool]: On list_iceberg_default: ROLLBACK
[0m23:25:08.303454 [debug] [ThreadPool]: On list_iceberg_default: Close
[0m23:25:08.304259 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:25:08.304574 [debug] [MainThread]: Connection 'list_iceberg_default' was properly closed.
[0m23:25:08.304809 [info ] [MainThread]: 
[0m23:25:08.305060 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 41.50 seconds (41.50s).
[0m23:25:08.305521 [error] [MainThread]: Encountered an error:
Database Error
  TrinoExternalError(type=EXTERNAL, name=HIVE_METASTORE_ERROR, message="172.20.0.2:9083: java.net.SocketTimeoutException: Read timed out", query_id=20250318_002757_00007_egrtd)
[0m23:25:08.306886 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 42.9615, "process_in_blocks": "0", "process_kernel_time": 0.226299, "process_mem_max_rss": "130269184", "process_out_blocks": "0", "process_user_time": 2.25501}
[0m23:25:08.307279 [debug] [MainThread]: Command `dbt run` failed at 23:25:08.307215 after 42.96 seconds
[0m23:25:08.307548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067dd610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119696040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1196cc1f0>]}
[0m23:25:08.307810 [debug] [MainThread]: Flushing usage events
[0m23:25:08.475577 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:43:44.092634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117a5640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113063640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113063160>]}


============================== 23:43:44.095678 | 6028474d-fd3e-41b1-a09f-e6dc76d32762 ==============================
[0m23:43:44.095678 [info ] [MainThread]: Running with dbt=1.9.3
[0m23:43:44.096092 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ankurchopra/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/logs', 'debug': 'False', 'warn_error': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --models kafka_to_iceberg.events_streaming', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m23:43:44.283308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6028474d-fd3e-41b1-a09f-e6dc76d32762', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1104cd2e0>]}
[0m23:43:44.326852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6028474d-fd3e-41b1-a09f-e6dc76d32762', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c24eb0>]}
[0m23:43:44.327274 [info ] [MainThread]: Registered adapter: trino=1.8.5
[0m23:43:44.396616 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m23:43:44.498805 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:43:44.499109 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:43:44.533487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6028474d-fd3e-41b1-a09f-e6dc76d32762', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1139385e0>]}
[0m23:43:44.601871 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/target/manifest.json
[0m23:43:44.603639 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/target/semantic_manifest.json
[0m23:43:44.610595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6028474d-fd3e-41b1-a09f-e6dc76d32762', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113938910>]}
[0m23:43:44.610951 [info ] [MainThread]: Found 4 models, 3 data tests, 1 source, 456 macros
[0m23:43:44.611171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6028474d-fd3e-41b1-a09f-e6dc76d32762', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113959910>]}
[0m23:43:44.611887 [info ] [MainThread]: 
[0m23:43:44.612126 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:43:44.612309 [info ] [MainThread]: 
[0m23:43:44.612597 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m23:43:44.613078 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
[0m23:43:44.648251 [debug] [ThreadPool]: Using trino connection "list_iceberg"
[0m23:43:44.648539 [debug] [ThreadPool]: On list_iceberg: select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
/* dbt: dev */
[0m23:43:44.648719 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:43:44.648879 [warn ] [ThreadPool]: [[33mWARNING[0m]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.
You may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.
Visit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.
[0m23:43:44.649152 [debug] [ThreadPool]: Sending event: {'category': 'dbt', 'action': 'BehaviorChangeEvent', 'label': '6028474d-fd3e-41b1-a09f-e6dc76d32762', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a13ca0>]}
[0m23:43:44.820435 [debug] [ThreadPool]: SQL status: SUCCESS in 0.172 seconds
[0m23:43:44.821384 [debug] [ThreadPool]: On list_iceberg: Close
[0m23:43:44.824883 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_default)
[0m23:43:44.865147 [debug] [ThreadPool]: Using trino connection "list_iceberg_default"
[0m23:43:44.865539 [debug] [ThreadPool]: On list_iceberg_default: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'default') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'default'
/* dbt: dev */
[0m23:43:44.865765 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:44:26.100278 [debug] [ThreadPool]: Trino adapter: Trino query id: 20250318_003338_00009_egrtd
[0m23:44:26.101913 [debug] [ThreadPool]: Trino adapter: Trino error: TrinoExternalError(type=EXTERNAL, name=HIVE_METASTORE_ERROR, message="172.20.0.2:9083: java.net.SocketTimeoutException: Read timed out", query_id=20250318_003338_00009_egrtd)
[0m23:44:26.103069 [debug] [ThreadPool]: On list_iceberg_default: ROLLBACK
[0m23:44:26.103354 [debug] [ThreadPool]: On list_iceberg_default: Close
[0m23:44:26.104621 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:44:26.104942 [debug] [MainThread]: Connection 'list_iceberg_default' was properly closed.
[0m23:44:26.105282 [info ] [MainThread]: 
[0m23:44:26.105632 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 41.49 seconds (41.49s).
[0m23:44:26.106699 [error] [MainThread]: Encountered an error:
Database Error
  TrinoExternalError(type=EXTERNAL, name=HIVE_METASTORE_ERROR, message="172.20.0.2:9083: java.net.SocketTimeoutException: Read timed out", query_id=20250318_003338_00009_egrtd)
[0m23:44:26.108679 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 42.070568, "process_in_blocks": "0", "process_kernel_time": 0.21711, "process_mem_max_rss": "118226944", "process_out_blocks": "0", "process_user_time": 1.451149}
[0m23:44:26.109290 [debug] [MainThread]: Command `dbt run` failed at 23:44:26.109205 after 42.07 seconds
[0m23:44:26.109735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1117a5640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133c2ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1133c2b50>]}
[0m23:44:26.110150 [debug] [MainThread]: Flushing usage events
[0m23:44:26.275889 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:48:51.026388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ae2780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112798b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1127988c0>]}


============================== 23:48:51.029828 | b0042843-f17c-4102-9be1-dcf56fd22525 ==============================
[0m23:48:51.029828 [info ] [MainThread]: Running with dbt=1.9.3
[0m23:48:51.030162 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'False', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/ankurchopra/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models kafka_to_iceberg.kafka_view', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:48:51.160901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b0042843-f17c-4102-9be1-dcf56fd22525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112726ab0>]}
[0m23:48:51.190649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b0042843-f17c-4102-9be1-dcf56fd22525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1128578f0>]}
[0m23:48:51.191059 [info ] [MainThread]: Registered adapter: trino=1.9.0
[0m23:48:51.267523 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m23:48:51.344089 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 3 files changed.
[0m23:48:51.344422 [debug] [MainThread]: Partial parsing: added file: iceberg_project://models/kafka_to_iceberg/kafka_view.sql
[0m23:48:51.344600 [debug] [MainThread]: Partial parsing: added file: iceberg_project://macros/direct_kafka_to_iceberg.sql
[0m23:48:51.344923 [debug] [MainThread]: Partial parsing: updated file: dbt_trino://macros/materializations/snapshot.sql
[0m23:48:51.345135 [debug] [MainThread]: Partial parsing: updated file: dbt_trino://macros/materializations/incremental.sql
[0m23:48:51.345454 [debug] [MainThread]: Partial parsing: updated file: dbt_trino://macros/adapters.sql
[0m23:48:51.578908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b0042843-f17c-4102-9be1-dcf56fd22525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113884ce0>]}
[0m23:48:51.626979 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/target/manifest.json
[0m23:48:51.629343 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/target/semantic_manifest.json
[0m23:48:51.636926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b0042843-f17c-4102-9be1-dcf56fd22525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113aa9fd0>]}
[0m23:48:51.637188 [info ] [MainThread]: Found 5 models, 3 data tests, 1 source, 458 macros
[0m23:48:51.637356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b0042843-f17c-4102-9be1-dcf56fd22525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113ab69c0>]}
[0m23:48:51.638183 [info ] [MainThread]: 
[0m23:48:51.638363 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m23:48:51.638507 [info ] [MainThread]: 
[0m23:48:51.638744 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m23:48:51.639209 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
[0m23:48:51.682711 [debug] [ThreadPool]: Using trino connection "list_iceberg"
[0m23:48:51.682970 [debug] [ThreadPool]: On list_iceberg: select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
/* dbt: dev */
[0m23:48:51.683126 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:48:51.683257 [warn ] [ThreadPool]: [[33mWARNING[0m]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.
You may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.
Visit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.
[0m23:48:51.683487 [debug] [ThreadPool]: Sending event: {'category': 'dbt', 'action': 'BehaviorChangeEvent', 'label': 'b0042843-f17c-4102-9be1-dcf56fd22525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11382f110>]}
[0m23:48:51.823049 [debug] [ThreadPool]: SQL status: SUCCESS in 0.140 seconds
[0m23:48:51.823971 [debug] [ThreadPool]: On list_iceberg: Close
[0m23:48:51.826974 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_default)
[0m23:48:51.834810 [debug] [ThreadPool]: Using trino connection "list_iceberg_default"
[0m23:48:51.835037 [debug] [ThreadPool]: On list_iceberg_default: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'default') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'default'
/* dbt: dev */
[0m23:48:51.835227 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:49:33.061240 [debug] [ThreadPool]: Trino adapter: Trino query id: 20250318_003845_00011_egrtd
[0m23:49:33.062823 [debug] [ThreadPool]: Trino adapter: Trino error: TrinoExternalError(type=EXTERNAL, name=HIVE_METASTORE_ERROR, message="172.20.0.2:9083: java.net.SocketTimeoutException: Read timed out", query_id=20250318_003845_00011_egrtd)
[0m23:49:33.063784 [debug] [ThreadPool]: On list_iceberg_default: ROLLBACK
[0m23:49:33.064253 [debug] [ThreadPool]: On list_iceberg_default: Close
[0m23:49:33.065511 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:49:33.065834 [debug] [MainThread]: Connection 'list_iceberg_default' was properly closed.
[0m23:49:33.066239 [info ] [MainThread]: 
[0m23:49:33.066611 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 41.43 seconds (41.43s).
[0m23:49:33.067532 [error] [MainThread]: Encountered an error:
Database Error
  TrinoExternalError(type=EXTERNAL, name=HIVE_METASTORE_ERROR, message="172.20.0.2:9083: java.net.SocketTimeoutException: Read timed out", query_id=20250318_003845_00011_egrtd)
[0m23:49:33.222674 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 42.261585, "process_in_blocks": "0", "process_kernel_time": 0.215699, "process_mem_max_rss": "119226368", "process_out_blocks": "0", "process_user_time": 1.391065}
[0m23:49:33.223815 [debug] [MainThread]: Command `dbt run` failed at 23:49:33.223547 after 42.26 seconds
[0m23:49:33.225162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112726810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112f8b290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113e9cdd0>]}
[0m23:49:33.225680 [debug] [MainThread]: Flushing usage events
[0m23:49:33.406925 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m23:49:34.504742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1188ce180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ab989e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ab98740>]}


============================== 23:49:34.507764 | f941df63-f041-4a52-a991-77a015cc10c1 ==============================
[0m23:49:34.507764 [info ] [MainThread]: Running with dbt=1.9.3
[0m23:49:34.508100 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ankurchopra/.dbt', 'debug': 'False', 'warn_error': 'False', 'log_path': '/Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run-operation direct_kafka_to_iceberg --args {"target_table": "iceberg.default.raw_events_streaming", "limit": 1000}', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:49:34.606281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f941df63-f041-4a52-a991-77a015cc10c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ac85520>]}
[0m23:49:34.636049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f941df63-f041-4a52-a991-77a015cc10c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119951dc0>]}
[0m23:49:34.636457 [info ] [MainThread]: Registered adapter: trino=1.9.0
[0m23:49:34.694013 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m23:49:34.769949 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:49:34.770205 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:49:34.795535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f941df63-f041-4a52-a991-77a015cc10c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b0ec6e0>]}
[0m23:49:34.844169 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/target/manifest.json
[0m23:49:34.846215 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/target/semantic_manifest.json
[0m23:49:34.849724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f941df63-f041-4a52-a991-77a015cc10c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b4168d0>]}
[0m23:49:34.849973 [info ] [MainThread]: Found 5 models, 3 data tests, 1 source, 458 macros
[0m23:49:34.850144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f941df63-f041-4a52-a991-77a015cc10c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b45c230>]}
[0m23:49:34.850413 [debug] [MainThread]: Acquiring new trino connection 'macro_direct_kafka_to_iceberg'
[0m23:49:34.850572 [debug] [MainThread]: On macro_direct_kafka_to_iceberg: COMMIT
[0m23:49:34.884892 [debug] [MainThread]: Using trino connection "macro_direct_kafka_to_iceberg"
[0m23:49:34.885137 [debug] [MainThread]: On macro_direct_kafka_to_iceberg: CREATE TABLE IF NOT EXISTS iceberg.default.raw_events_streaming (
    id BIGINT,
    name VARCHAR,
    created_at TIMESTAMP,
    kafka_partition INTEGER,
    kafka_offset BIGINT,
    kafka_timestamp TIMESTAMP,
    processed_at TIMESTAMP
)
WITH (
    format = 'PARQUET'
)
/* dbt: dev */
[0m23:49:34.885292 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:49:34.885421 [warn ] [MainThread]: [[33mWARNING[0m]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.
You may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.
Visit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.
[0m23:49:34.885662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'BehaviorChangeEvent', 'label': 'f941df63-f041-4a52-a991-77a015cc10c1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b7594f0>]}
[0m23:49:34.934899 [debug] [MainThread]: Trino adapter: Trino query id: 20250318_003928_00012_egrtd
[0m23:49:34.935222 [debug] [MainThread]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=NOT_SUPPORTED, message="Timestamp precision (3) not supported for Iceberg. Use "timestamp(6)" instead.", query_id=20250318_003928_00012_egrtd)
[0m23:49:34.935535 [debug] [MainThread]: On macro_direct_kafka_to_iceberg: Close
[0m23:49:34.935806 [error] [MainThread]: Encountered an error while running operation: Database Error
  TrinoUserError(type=USER_ERROR, name=NOT_SUPPORTED, message="Timestamp precision (3) not supported for Iceberg. Use "timestamp(6)" instead.", query_id=20250318_003928_00012_egrtd)
[0m23:49:34.941011 [debug] [MainThread]: Traceback (most recent call last):
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/dbt/adapters/trino/connections.py", line 443, in exception_handler
    yield
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/dbt/adapters/sql/connections.py", line 147, in add_query
    _execute_query_with_retry(
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/dbt/adapters/sql/connections.py", line 97, in _execute_query_with_retry
    cursor.execute(sql, bindings)
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/dbt/adapters/trino/connections.py", line 393, in execute
    result = self._cursor.execute(sql, params=bindings)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/trino/dbapi.py", line 614, in execute
    self._iterator = iter(self._query.execute())
                          ^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/trino/client.py", line 900, in execute
    self._result.rows += self.fetch()
                         ^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/trino/client.py", line 920, in fetch
    status = self._request.process(response)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/trino/client.py", line 689, in process
    raise self._process_error(response["error"], response.get("id"))
trino.exceptions.TrinoUserError: TrinoUserError(type=USER_ERROR, name=NOT_SUPPORTED, message="Timestamp precision (3) not supported for Iceberg. Use "timestamp(6)" instead.", query_id=20250318_003928_00012_egrtd)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/dbt/task/run_operation.py", line 67, in run
    self._run_unsafe(package_name, macro_name)
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/dbt/task/run_operation.py", line 48, in _run_unsafe
    res = adapter.execute_macro(
          ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/dbt/adapters/base/impl.py", line 1198, in execute_macro
    result = macro_function(**kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/dbt_common/clients/jinja.py", line 421, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/dbt_common/clients/jinja.py", line 389, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 40, in macro
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/dbt/clients/jinja.py", line 82, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/dbt_common/clients/jinja.py", line 389, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 33, in macro
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/dbt/clients/jinja.py", line 82, in __call__
    return self.call_macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/dbt_common/clients/jinja.py", line 389, in call_macro
    return macro(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/jinja2/runtime.py", line 770, in __call__
    return self._invoke(arguments, autoescape)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/jinja2/runtime.py", line 784, in _invoke
    rv = self._func(*arguments)
         ^^^^^^^^^^^^^^^^^^^^^^
  File "<template>", line 52, in macro
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/jinja2/sandbox.py", line 401, in call
    return __context.call(__obj, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/jinja2/runtime.py", line 303, in call
    return __obj(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/dbt/adapters/base/impl.py", line 404, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/dbt/adapters/sql/connections.py", line 218, in execute
    _, cursor = self.add_query(sql, auto_begin)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/dbt/adapters/trino/connections.py", line 561, in add_query
    connection, cursor = parent.add_query(
                         ^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/dbt/adapters/sql/connections.py", line 130, in add_query
    with self.exception_handler(sql):
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/contextlib.py", line 158, in __exit__
    self.gen.throw(value)
  File "/opt/homebrew/Caskroom/miniforge/base/lib/python3.12/site-packages/dbt/adapters/trino/connections.py", line 454, in exception_handler
    raise DbtDatabaseError(msg)
dbt_common.exceptions.base.DbtDatabaseError: Database Error
  TrinoUserError(type=USER_ERROR, name=NOT_SUPPORTED, message="Timestamp precision (3) not supported for Iceberg. Use "timestamp(6)" instead.", query_id=20250318_003928_00012_egrtd)

[0m23:49:34.945366 [debug] [MainThread]: Wrote artifact RunResultsArtifact to /Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/target/run_results.json
[0m23:49:34.946356 [debug] [MainThread]: Resource report: {"command_name": "run-operation", "command_success": false, "command_wall_clock_time": 0.49980858, "process_in_blocks": "0", "process_kernel_time": 0.15434, "process_mem_max_rss": "116801536", "process_out_blocks": "0", "process_user_time": 0.977714}
[0m23:49:34.946627 [debug] [MainThread]: Command `dbt run-operation` failed at 23:49:34.946570 after 0.50 seconds
[0m23:49:34.946819 [debug] [MainThread]: Connection 'macro_direct_kafka_to_iceberg' was properly closed.
[0m23:49:34.946996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ab26a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b4162d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11b416750>]}
[0m23:49:34.947186 [debug] [MainThread]: Flushing usage events
[0m23:49:35.058702 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:01:18.028321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1037c9610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10467b640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10467b160>]}


============================== 00:01:18.031241 | 8061a270-d801-4e0e-843a-8ad68ed06cbe ==============================
[0m00:01:18.031241 [info ] [MainThread]: Running with dbt=1.9.3
[0m00:01:18.031641 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ankurchopra/.dbt', 'debug': 'False', 'warn_error': 'False', 'log_path': '/Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --models kafka_to_iceberg.events_streaming', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:01:18.223012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8061a270-d801-4e0e-843a-8ad68ed06cbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049542b0>]}
[0m00:01:18.266510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8061a270-d801-4e0e-843a-8ad68ed06cbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ac2250>]}
[0m00:01:18.267004 [info ] [MainThread]: Registered adapter: trino=1.8.5
[0m00:01:18.334869 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m00:01:18.411725 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m00:01:18.412093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8061a270-d801-4e0e-843a-8ad68ed06cbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049b9940>]}
[0m00:01:19.310499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8061a270-d801-4e0e-843a-8ad68ed06cbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052b5820>]}
[0m00:01:19.411821 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/target/manifest.json
[0m00:01:19.413446 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/target/semantic_manifest.json
[0m00:01:19.419500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8061a270-d801-4e0e-843a-8ad68ed06cbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052d17f0>]}
[0m00:01:19.419816 [info ] [MainThread]: Found 5 models, 3 data tests, 1 source, 458 macros
[0m00:01:19.420028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8061a270-d801-4e0e-843a-8ad68ed06cbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052b9550>]}
[0m00:01:19.420687 [info ] [MainThread]: 
[0m00:01:19.420899 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:01:19.421074 [info ] [MainThread]: 
[0m00:01:19.421341 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m00:01:19.421793 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
[0m00:01:19.452879 [debug] [ThreadPool]: Using trino connection "list_iceberg"
[0m00:01:19.453168 [debug] [ThreadPool]: On list_iceberg: select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
/* dbt: dev */
[0m00:01:19.453341 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:01:19.453502 [warn ] [ThreadPool]: [[33mWARNING[0m]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.
You may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.
Visit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.
[0m00:01:19.453767 [debug] [ThreadPool]: Sending event: {'category': 'dbt', 'action': 'BehaviorChangeEvent', 'label': '8061a270-d801-4e0e-843a-8ad68ed06cbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050b7a30>]}
[0m00:01:21.186822 [debug] [ThreadPool]: SQL status: SUCCESS in 1.733 seconds
[0m00:01:21.205331 [debug] [ThreadPool]: On list_iceberg: Close
[0m00:01:21.211206 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_default)
[0m00:01:21.223418 [debug] [ThreadPool]: Using trino connection "list_iceberg_default"
[0m00:01:21.223816 [debug] [ThreadPool]: On list_iceberg_default: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'default') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'default'
/* dbt: dev */
[0m00:01:21.224077 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:01:41.962152 [debug] [ThreadPool]: SQL status: SUCCESS in 20.738 seconds
[0m00:01:41.965458 [debug] [ThreadPool]: On list_iceberg_default: ROLLBACK
[0m00:01:41.965924 [debug] [ThreadPool]: On list_iceberg_default: Close
[0m00:01:41.969212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8061a270-d801-4e0e-843a-8ad68ed06cbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052d08b0>]}
[0m00:01:41.970677 [debug] [MainThread]: On master: COMMIT
[0m00:01:41.978630 [debug] [Thread-1  ]: Began running node model.iceberg_project.events_streaming
[0m00:01:41.980013 [info ] [Thread-1  ]: 1 of 1 START sql incremental model default.events_streaming .................... [RUN]
[0m00:01:41.980548 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_iceberg_default, now model.iceberg_project.events_streaming)
[0m00:01:41.981023 [debug] [Thread-1  ]: Began compiling node model.iceberg_project.events_streaming
[0m00:01:41.987543 [debug] [Thread-1  ]: Using trino connection "model.iceberg_project.events_streaming"
[0m00:01:41.987906 [debug] [Thread-1  ]: On model.iceberg_project.events_streaming: SELECT -1 as max_offset
/* dbt: dev */
[0m00:01:41.988120 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:01:42.099712 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.111 seconds
[0m00:01:42.101408 [debug] [Thread-1  ]: Writing injected SQL for node "model.iceberg_project.events_streaming"
[0m00:01:42.102418 [debug] [Thread-1  ]: Began executing node model.iceberg_project.events_streaming
[0m00:01:42.143406 [debug] [Thread-1  ]: On model.iceberg_project.events_streaming: Close
[0m00:01:42.147807 [debug] [Thread-1  ]: Compilation Error in model events_streaming (models/kafka_to_iceberg/events_streaming.sql)
  
            You can specify either 'file_format' or 'properties.format' configurations, but not both.
          
  
  > in macro properties (macros/adapters.sql)
  > called by macro trino__create_table_as (macros/adapters.sql)
  > called by macro create_table_as (macros/relations/table/create.sql)
  > called by macro statement (macros/etc/statement.sql)
  > called by macro materialization_incremental_trino (macros/materializations/incremental.sql)
  > called by model events_streaming (models/kafka_to_iceberg/events_streaming.sql)
[0m00:01:42.149837 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8061a270-d801-4e0e-843a-8ad68ed06cbe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104d98760>]}
[0m00:01:42.150608 [error] [Thread-1  ]: 1 of 1 ERROR creating sql incremental model default.events_streaming ........... [[31mERROR[0m in 0.17s]
[0m00:01:42.151297 [debug] [Thread-1  ]: Finished running node model.iceberg_project.events_streaming
[0m00:01:42.151943 [debug] [Thread-4  ]: Marking all children of 'model.iceberg_project.events_streaming' to be skipped because of status 'error'.  Reason: Compilation Error in model events_streaming (models/kafka_to_iceberg/events_streaming.sql)
  
            You can specify either 'file_format' or 'properties.format' configurations, but not both.
          
  
  > in macro properties (macros/adapters.sql)
  > called by macro trino__create_table_as (macros/adapters.sql)
  > called by macro create_table_as (macros/relations/table/create.sql)
  > called by macro statement (macros/etc/statement.sql)
  > called by macro materialization_incremental_trino (macros/materializations/incremental.sql)
  > called by model events_streaming (models/kafka_to_iceberg/events_streaming.sql).
[0m00:01:42.153375 [debug] [MainThread]: On master: COMMIT
[0m00:01:42.153652 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:01:42.153848 [debug] [MainThread]: Connection 'model.iceberg_project.events_streaming' was properly closed.
[0m00:01:42.154230 [info ] [MainThread]: 
[0m00:01:42.154726 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 22.73 seconds (22.73s).
[0m00:01:42.155416 [debug] [MainThread]: Command end result
[0m00:01:42.174046 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/target/manifest.json
[0m00:01:42.176322 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/target/semantic_manifest.json
[0m00:01:42.181142 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/target/run_results.json
[0m00:01:42.181465 [info ] [MainThread]: 
[0m00:01:42.181749 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m00:01:42.181970 [info ] [MainThread]: 
[0m00:01:42.182257 [error] [MainThread]:   Compilation Error in model events_streaming (models/kafka_to_iceberg/events_streaming.sql)
  
            You can specify either 'file_format' or 'properties.format' configurations, but not both.
          
  
  > in macro properties (macros/adapters.sql)
  > called by macro trino__create_table_as (macros/adapters.sql)
  > called by macro create_table_as (macros/relations/table/create.sql)
  > called by macro statement (macros/etc/statement.sql)
  > called by macro materialization_incremental_trino (macros/materializations/incremental.sql)
  > called by model events_streaming (models/kafka_to_iceberg/events_streaming.sql)
[0m00:01:42.182475 [info ] [MainThread]: 
[0m00:01:42.182706 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m00:01:42.184463 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 24.20896, "process_in_blocks": "0", "process_kernel_time": 0.221284, "process_mem_max_rss": "127549440", "process_out_blocks": "0", "process_user_time": 2.278501}
[0m00:01:42.184976 [debug] [MainThread]: Command `dbt run` failed at 00:01:42.184912 after 24.21 seconds
[0m00:01:42.185293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1037c9610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e132b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052d1070>]}
[0m00:01:42.185541 [debug] [MainThread]: Flushing usage events
[0m00:01:42.363464 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:03:05.014953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103469610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104523640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104523160>]}


============================== 00:03:05.017929 | 4021dfb7-da97-4b9f-a3f2-cb4b5679262f ==============================
[0m00:03:05.017929 [info ] [MainThread]: Running with dbt=1.9.3
[0m00:03:05.018336 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'False', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/logs', 'profiles_dir': '/Users/ankurchopra/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models kafka_to_iceberg.events_streaming', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m00:03:05.210536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4021dfb7-da97-4b9f-a3f2-cb4b5679262f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050332b0>]}
[0m00:03:05.256235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4021dfb7-da97-4b9f-a3f2-cb4b5679262f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103762250>]}
[0m00:03:05.256787 [info ] [MainThread]: Registered adapter: trino=1.8.5
[0m00:03:05.325698 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m00:03:05.426234 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:03:05.427065 [debug] [MainThread]: Partial parsing: updated file: iceberg_project://models/kafka_to_iceberg/events_streaming.sql
[0m00:03:05.777446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4021dfb7-da97-4b9f-a3f2-cb4b5679262f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10561fb50>]}
[0m00:03:05.845353 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/target/manifest.json
[0m00:03:05.846704 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/target/semantic_manifest.json
[0m00:03:05.854010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4021dfb7-da97-4b9f-a3f2-cb4b5679262f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054ed4f0>]}
[0m00:03:05.854354 [info ] [MainThread]: Found 5 models, 3 data tests, 1 source, 458 macros
[0m00:03:05.854572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4021dfb7-da97-4b9f-a3f2-cb4b5679262f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054edb20>]}
[0m00:03:05.855252 [info ] [MainThread]: 
[0m00:03:05.855478 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:03:05.855655 [info ] [MainThread]: 
[0m00:03:05.855920 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m00:03:05.856377 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
[0m00:03:05.887928 [debug] [ThreadPool]: Using trino connection "list_iceberg"
[0m00:03:05.888215 [debug] [ThreadPool]: On list_iceberg: select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
/* dbt: dev */
[0m00:03:05.888390 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:03:05.888552 [warn ] [ThreadPool]: [[33mWARNING[0m]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.
You may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.
Visit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.
[0m00:03:05.888813 [debug] [ThreadPool]: Sending event: {'category': 'dbt', 'action': 'BehaviorChangeEvent', 'label': '4021dfb7-da97-4b9f-a3f2-cb4b5679262f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058fac70>]}
[0m00:03:06.107523 [debug] [ThreadPool]: SQL status: SUCCESS in 0.219 seconds
[0m00:03:06.108565 [debug] [ThreadPool]: On list_iceberg: Close
[0m00:03:06.112069 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_default)
[0m00:03:06.121261 [debug] [ThreadPool]: Using trino connection "list_iceberg_default"
[0m00:03:06.121643 [debug] [ThreadPool]: On list_iceberg_default: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'default') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'default'
/* dbt: dev */
[0m00:03:06.122013 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:03:06.373311 [debug] [ThreadPool]: SQL status: SUCCESS in 0.251 seconds
[0m00:03:06.374317 [debug] [ThreadPool]: On list_iceberg_default: ROLLBACK
[0m00:03:06.374539 [debug] [ThreadPool]: On list_iceberg_default: Close
[0m00:03:06.375442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4021dfb7-da97-4b9f-a3f2-cb4b5679262f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058fb4c0>]}
[0m00:03:06.375846 [debug] [MainThread]: On master: COMMIT
[0m00:03:06.377551 [debug] [Thread-1  ]: Began running node model.iceberg_project.events_streaming
[0m00:03:06.377959 [info ] [Thread-1  ]: 1 of 1 START sql incremental model default.events_streaming .................... [RUN]
[0m00:03:06.378242 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_iceberg_default, now model.iceberg_project.events_streaming)
[0m00:03:06.378523 [debug] [Thread-1  ]: Began compiling node model.iceberg_project.events_streaming
[0m00:03:06.382716 [debug] [Thread-1  ]: Using trino connection "model.iceberg_project.events_streaming"
[0m00:03:06.382966 [debug] [Thread-1  ]: On model.iceberg_project.events_streaming: SELECT -1 as max_offset
/* dbt: dev */
[0m00:03:06.383171 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:03:06.420856 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.038 seconds
[0m00:03:06.422024 [debug] [Thread-1  ]: Writing injected SQL for node "model.iceberg_project.events_streaming"
[0m00:03:06.422557 [debug] [Thread-1  ]: Began executing node model.iceberg_project.events_streaming
[0m00:03:06.460210 [debug] [Thread-1  ]: On model.iceberg_project.events_streaming: Close
[0m00:03:06.463884 [debug] [Thread-1  ]: Compilation Error in model events_streaming (models/kafka_to_iceberg/events_streaming.sql)
  
            You can specify either 'file_format' or 'properties.format' configurations, but not both.
          
  
  > in macro properties (macros/adapters.sql)
  > called by macro trino__create_table_as (macros/adapters.sql)
  > called by macro create_table_as (macros/relations/table/create.sql)
  > called by macro statement (macros/etc/statement.sql)
  > called by macro materialization_incremental_trino (macros/materializations/incremental.sql)
  > called by model events_streaming (models/kafka_to_iceberg/events_streaming.sql)
[0m00:03:06.465231 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4021dfb7-da97-4b9f-a3f2-cb4b5679262f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f77940>]}
[0m00:03:06.465661 [error] [Thread-1  ]: 1 of 1 ERROR creating sql incremental model default.events_streaming ........... [[31mERROR[0m in 0.09s]
[0m00:03:06.466043 [debug] [Thread-1  ]: Finished running node model.iceberg_project.events_streaming
[0m00:03:06.466408 [debug] [Thread-4  ]: Marking all children of 'model.iceberg_project.events_streaming' to be skipped because of status 'error'.  Reason: Compilation Error in model events_streaming (models/kafka_to_iceberg/events_streaming.sql)
  
            You can specify either 'file_format' or 'properties.format' configurations, but not both.
          
  
  > in macro properties (macros/adapters.sql)
  > called by macro trino__create_table_as (macros/adapters.sql)
  > called by macro create_table_as (macros/relations/table/create.sql)
  > called by macro statement (macros/etc/statement.sql)
  > called by macro materialization_incremental_trino (macros/materializations/incremental.sql)
  > called by model events_streaming (models/kafka_to_iceberg/events_streaming.sql).
[0m00:03:06.467047 [debug] [MainThread]: On master: COMMIT
[0m00:03:06.467270 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:03:06.467443 [debug] [MainThread]: Connection 'model.iceberg_project.events_streaming' was properly closed.
[0m00:03:06.467628 [info ] [MainThread]: 
[0m00:03:06.467819 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.61 seconds (0.61s).
[0m00:03:06.468219 [debug] [MainThread]: Command end result
[0m00:03:06.485025 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/target/manifest.json
[0m00:03:06.486107 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/target/semantic_manifest.json
[0m00:03:06.490121 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/target/run_results.json
[0m00:03:06.490329 [info ] [MainThread]: 
[0m00:03:06.490570 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m00:03:06.490766 [info ] [MainThread]: 
[0m00:03:06.491007 [error] [MainThread]:   Compilation Error in model events_streaming (models/kafka_to_iceberg/events_streaming.sql)
  
            You can specify either 'file_format' or 'properties.format' configurations, but not both.
          
  
  > in macro properties (macros/adapters.sql)
  > called by macro trino__create_table_as (macros/adapters.sql)
  > called by macro create_table_as (macros/relations/table/create.sql)
  > called by macro statement (macros/etc/statement.sql)
  > called by macro materialization_incremental_trino (macros/materializations/incremental.sql)
  > called by model events_streaming (models/kafka_to_iceberg/events_streaming.sql)
[0m00:03:06.491212 [info ] [MainThread]: 
[0m00:03:06.491405 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m00:03:06.492704 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.531392, "process_in_blocks": "0", "process_kernel_time": 0.196161, "process_mem_max_rss": "123371520", "process_out_blocks": "0", "process_user_time": 1.625126}
[0m00:03:06.492991 [debug] [MainThread]: Command `dbt run` failed at 00:03:06.492943 after 1.53 seconds
[0m00:03:06.493227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103469610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1035e9e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103762250>]}
[0m00:03:06.493458 [debug] [MainThread]: Flushing usage events
[0m00:03:06.674344 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:03:30.496194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e39670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cec700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108cec100>]}


============================== 00:03:30.498867 | 9426a652-cd3b-4f55-8ced-615b56ae6a83 ==============================
[0m00:03:30.498867 [info ] [MainThread]: Running with dbt=1.9.3
[0m00:03:30.499246 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'False', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/logs', 'version_check': 'True', 'profiles_dir': '/Users/ankurchopra/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --models kafka_to_iceberg.events_streaming', 'send_anonymous_usage_stats': 'True'}
[0m00:03:30.654382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9426a652-cd3b-4f55-8ced-615b56ae6a83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fb2af0>]}
[0m00:03:30.698308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9426a652-cd3b-4f55-8ced-615b56ae6a83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109041880>]}
[0m00:03:30.698766 [info ] [MainThread]: Registered adapter: trino=1.8.5
[0m00:03:30.767680 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m00:03:30.768176 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m00:03:30.768428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9426a652-cd3b-4f55-8ced-615b56ae6a83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109144190>]}
[0m00:03:31.715535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9426a652-cd3b-4f55-8ced-615b56ae6a83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1098fe8b0>]}
[0m00:03:31.784088 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/target/manifest.json
[0m00:03:31.785352 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/target/semantic_manifest.json
[0m00:03:31.791440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9426a652-cd3b-4f55-8ced-615b56ae6a83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1099363d0>]}
[0m00:03:31.791793 [info ] [MainThread]: Found 5 models, 3 data tests, 1 source, 458 macros
[0m00:03:31.792009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9426a652-cd3b-4f55-8ced-615b56ae6a83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109987c40>]}
[0m00:03:31.792689 [info ] [MainThread]: 
[0m00:03:31.792902 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:03:31.793079 [info ] [MainThread]: 
[0m00:03:31.793344 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m00:03:31.793807 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
[0m00:03:31.856101 [debug] [ThreadPool]: Using trino connection "list_iceberg"
[0m00:03:31.856397 [debug] [ThreadPool]: On list_iceberg: select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
/* dbt: dev */
[0m00:03:31.856571 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:03:31.856730 [warn ] [ThreadPool]: [[33mWARNING[0m]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.
You may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.
Visit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.
[0m00:03:31.856994 [debug] [ThreadPool]: Sending event: {'category': 'dbt', 'action': 'BehaviorChangeEvent', 'label': '9426a652-cd3b-4f55-8ced-615b56ae6a83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109723310>]}
[0m00:03:32.000703 [debug] [ThreadPool]: SQL status: SUCCESS in 0.144 seconds
[0m00:03:32.001861 [debug] [ThreadPool]: On list_iceberg: Close
[0m00:03:32.005271 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_default)
[0m00:03:32.015208 [debug] [ThreadPool]: Using trino connection "list_iceberg_default"
[0m00:03:32.015517 [debug] [ThreadPool]: On list_iceberg_default: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'default') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'default'
/* dbt: dev */
[0m00:03:32.015747 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:03:32.242946 [debug] [ThreadPool]: SQL status: SUCCESS in 0.227 seconds
[0m00:03:32.244915 [debug] [ThreadPool]: On list_iceberg_default: ROLLBACK
[0m00:03:32.245287 [debug] [ThreadPool]: On list_iceberg_default: Close
[0m00:03:32.246130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9426a652-cd3b-4f55-8ced-615b56ae6a83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10991d880>]}
[0m00:03:32.246454 [debug] [MainThread]: On master: COMMIT
[0m00:03:32.248222 [debug] [Thread-1  ]: Began running node model.iceberg_project.events_streaming
[0m00:03:32.248843 [info ] [Thread-1  ]: 1 of 1 START sql incremental model default.events_streaming .................... [RUN]
[0m00:03:32.249175 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_iceberg_default, now model.iceberg_project.events_streaming)
[0m00:03:32.249424 [debug] [Thread-1  ]: Began compiling node model.iceberg_project.events_streaming
[0m00:03:32.254004 [debug] [Thread-1  ]: Using trino connection "model.iceberg_project.events_streaming"
[0m00:03:32.254337 [debug] [Thread-1  ]: On model.iceberg_project.events_streaming: SELECT -1 as max_offset
/* dbt: dev */
[0m00:03:32.254566 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:03:32.307972 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.053 seconds
[0m00:03:32.309155 [debug] [Thread-1  ]: Writing injected SQL for node "model.iceberg_project.events_streaming"
[0m00:03:32.309889 [debug] [Thread-1  ]: Began executing node model.iceberg_project.events_streaming
[0m00:03:32.347305 [debug] [Thread-1  ]: On model.iceberg_project.events_streaming: Close
[0m00:03:32.350866 [debug] [Thread-1  ]: Compilation Error in model events_streaming (models/kafka_to_iceberg/events_streaming.sql)
  
            You can specify either 'file_format' or 'properties.format' configurations, but not both.
          
  
  > in macro properties (macros/adapters.sql)
  > called by macro trino__create_table_as (macros/adapters.sql)
  > called by macro create_table_as (macros/relations/table/create.sql)
  > called by macro statement (macros/etc/statement.sql)
  > called by macro materialization_incremental_trino (macros/materializations/incremental.sql)
  > called by model events_streaming (models/kafka_to_iceberg/events_streaming.sql)
[0m00:03:32.352201 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9426a652-cd3b-4f55-8ced-615b56ae6a83', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10992f2e0>]}
[0m00:03:32.352621 [error] [Thread-1  ]: 1 of 1 ERROR creating sql incremental model default.events_streaming ........... [[31mERROR[0m in 0.10s]
[0m00:03:32.352994 [debug] [Thread-1  ]: Finished running node model.iceberg_project.events_streaming
[0m00:03:32.353363 [debug] [Thread-4  ]: Marking all children of 'model.iceberg_project.events_streaming' to be skipped because of status 'error'.  Reason: Compilation Error in model events_streaming (models/kafka_to_iceberg/events_streaming.sql)
  
            You can specify either 'file_format' or 'properties.format' configurations, but not both.
          
  
  > in macro properties (macros/adapters.sql)
  > called by macro trino__create_table_as (macros/adapters.sql)
  > called by macro create_table_as (macros/relations/table/create.sql)
  > called by macro statement (macros/etc/statement.sql)
  > called by macro materialization_incremental_trino (macros/materializations/incremental.sql)
  > called by model events_streaming (models/kafka_to_iceberg/events_streaming.sql).
[0m00:03:32.354015 [debug] [MainThread]: On master: COMMIT
[0m00:03:32.354248 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:03:32.354422 [debug] [MainThread]: Connection 'model.iceberg_project.events_streaming' was properly closed.
[0m00:03:32.354616 [info ] [MainThread]: 
[0m00:03:32.354809 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.56 seconds (0.56s).
[0m00:03:32.355210 [debug] [MainThread]: Command end result
[0m00:03:32.371096 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/target/manifest.json
[0m00:03:32.372337 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/target/semantic_manifest.json
[0m00:03:32.376603 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/target/run_results.json
[0m00:03:32.376889 [info ] [MainThread]: 
[0m00:03:32.377148 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m00:03:32.377364 [info ] [MainThread]: 
[0m00:03:32.377621 [error] [MainThread]:   Compilation Error in model events_streaming (models/kafka_to_iceberg/events_streaming.sql)
  
            You can specify either 'file_format' or 'properties.format' configurations, but not both.
          
  
  > in macro properties (macros/adapters.sql)
  > called by macro trino__create_table_as (macros/adapters.sql)
  > called by macro create_table_as (macros/relations/table/create.sql)
  > called by macro statement (macros/etc/statement.sql)
  > called by macro materialization_incremental_trino (macros/materializations/incremental.sql)
  > called by model events_streaming (models/kafka_to_iceberg/events_streaming.sql)
[0m00:03:32.377837 [info ] [MainThread]: 
[0m00:03:32.378037 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m00:03:32.379469 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.9366263, "process_in_blocks": "0", "process_kernel_time": 0.180042, "process_mem_max_rss": "128581632", "process_out_blocks": "0", "process_user_time": 2.141222}
[0m00:03:32.379852 [debug] [MainThread]: Command `dbt run` failed at 00:03:32.379796 after 1.94 seconds
[0m00:03:32.380119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e39670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109936be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094c88b0>]}
[0m00:03:32.380366 [debug] [MainThread]: Flushing usage events
[0m00:03:32.502333 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:04:06.295409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078555e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c23640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109c23130>]}


============================== 00:04:06.298252 | 6b7d911d-9ce4-4415-86ba-cf040740129b ==============================
[0m00:04:06.298252 [info ] [MainThread]: Running with dbt=1.9.3
[0m00:04:06.298626 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'False', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/logs', 'version_check': 'True', 'profiles_dir': '/Users/ankurchopra/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models kafka_to_iceberg.events_streaming', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:04:06.488536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6b7d911d-9ce4-4415-86ba-cf040740129b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068892e0>]}
[0m00:04:06.531928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6b7d911d-9ce4-4415-86ba-cf040740129b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a83f880>]}
[0m00:04:06.532359 [info ] [MainThread]: Registered adapter: trino=1.8.5
[0m00:04:06.599843 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m00:04:06.724828 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:04:06.725893 [debug] [MainThread]: Partial parsing: updated file: iceberg_project://models/kafka_to_iceberg/events_streaming.sql
[0m00:04:07.080228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6b7d911d-9ce4-4415-86ba-cf040740129b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10815be20>]}
[0m00:04:07.149209 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/target/manifest.json
[0m00:04:07.150442 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/target/semantic_manifest.json
[0m00:04:07.164049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6b7d911d-9ce4-4415-86ba-cf040740129b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa8e4f0>]}
[0m00:04:07.164397 [info ] [MainThread]: Found 5 models, 3 data tests, 1 source, 458 macros
[0m00:04:07.164622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b7d911d-9ce4-4415-86ba-cf040740129b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ae63280>]}
[0m00:04:07.165339 [info ] [MainThread]: 
[0m00:04:07.165563 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:04:07.165752 [info ] [MainThread]: 
[0m00:04:07.166020 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m00:04:07.166494 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
[0m00:04:07.197738 [debug] [ThreadPool]: Using trino connection "list_iceberg"
[0m00:04:07.198030 [debug] [ThreadPool]: On list_iceberg: select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
/* dbt: dev */
[0m00:04:07.198210 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:04:07.198380 [warn ] [ThreadPool]: [[33mWARNING[0m]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.
You may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.
Visit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.
[0m00:04:07.198648 [debug] [ThreadPool]: Sending event: {'category': 'dbt', 'action': 'BehaviorChangeEvent', 'label': '6b7d911d-9ce4-4415-86ba-cf040740129b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bc13d90>]}
[0m00:04:07.394751 [debug] [ThreadPool]: SQL status: SUCCESS in 0.196 seconds
[0m00:04:07.395868 [debug] [ThreadPool]: On list_iceberg: Close
[0m00:04:07.399414 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_default)
[0m00:04:07.409153 [debug] [ThreadPool]: Using trino connection "list_iceberg_default"
[0m00:04:07.409512 [debug] [ThreadPool]: On list_iceberg_default: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'default') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'default'
/* dbt: dev */
[0m00:04:07.409888 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:04:07.650662 [debug] [ThreadPool]: SQL status: SUCCESS in 0.241 seconds
[0m00:04:07.652294 [debug] [ThreadPool]: On list_iceberg_default: ROLLBACK
[0m00:04:07.652637 [debug] [ThreadPool]: On list_iceberg_default: Close
[0m00:04:07.653581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6b7d911d-9ce4-4415-86ba-cf040740129b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a8fb550>]}
[0m00:04:07.654010 [debug] [MainThread]: On master: COMMIT
[0m00:04:07.655818 [debug] [Thread-1  ]: Began running node model.iceberg_project.events_streaming
[0m00:04:07.656286 [info ] [Thread-1  ]: 1 of 1 START sql incremental model default.events_streaming .................... [RUN]
[0m00:04:07.656615 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_iceberg_default, now model.iceberg_project.events_streaming)
[0m00:04:07.656862 [debug] [Thread-1  ]: Began compiling node model.iceberg_project.events_streaming
[0m00:04:07.661298 [debug] [Thread-1  ]: Using trino connection "model.iceberg_project.events_streaming"
[0m00:04:07.661678 [debug] [Thread-1  ]: On model.iceberg_project.events_streaming: SELECT -1 as max_offset
/* dbt: dev */
[0m00:04:07.661887 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:04:07.701641 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.040 seconds
[0m00:04:07.702850 [debug] [Thread-1  ]: Writing injected SQL for node "model.iceberg_project.events_streaming"
[0m00:04:07.703762 [debug] [Thread-1  ]: Began executing node model.iceberg_project.events_streaming
[0m00:04:07.743510 [debug] [Thread-1  ]: Writing runtime sql for node "model.iceberg_project.events_streaming"
[0m00:04:07.746364 [debug] [Thread-1  ]: Using trino connection "model.iceberg_project.events_streaming"
[0m00:04:07.746710 [debug] [Thread-1  ]: On model.iceberg_project.events_streaming: create table "iceberg"."default"."events_streaming"
      
      WITH (write.format.default = PARQUET,
  compression-codec = GZIP,
  format = 'parquet')
    as (
      







    


WITH kafka_data AS (
    SELECT
        CAST(JSON_EXTRACT_SCALAR(CAST(message AS VARCHAR), '$.id') AS BIGINT) AS id,
        JSON_EXTRACT_SCALAR(CAST(message AS VARCHAR), '$.name') AS name,
        CAST(JSON_EXTRACT_SCALAR(CAST(message AS VARCHAR), '$.created_at') AS TIMESTAMP(6)) AS created_at,
        _kafka_partition,
        _kafka_offset
    FROM "kafka"."default"."events_topic"
    
)

SELECT
    id,
    name,
    created_at,
    _kafka_partition,
    _kafka_offset,
    CAST(CURRENT_TIMESTAMP AS TIMESTAMP(6)) AS processed_at
FROM kafka_data
WHERE id IS NOT NULL
    )
/* dbt: dev */
[0m00:04:07.776904 [debug] [Thread-1  ]: Trino adapter: Trino query id: 20250318_040407_00012_j25rb
[0m00:04:07.777331 [debug] [Thread-1  ]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message="line 3:18: mismatched input '.'. Expecting: '='", query_id=20250318_040407_00012_j25rb)
[0m00:04:07.777647 [debug] [Thread-1  ]: On model.iceberg_project.events_streaming: ROLLBACK
[0m00:04:07.777860 [debug] [Thread-1  ]: On model.iceberg_project.events_streaming: Close
[0m00:04:07.782836 [debug] [Thread-1  ]: Database Error in model events_streaming (models/kafka_to_iceberg/events_streaming.sql)
  TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message="line 3:18: mismatched input '.'. Expecting: '='", query_id=20250318_040407_00012_j25rb)
  compiled code at target/run/iceberg_project/models/kafka_to_iceberg/events_streaming.sql
[0m00:04:07.784392 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6b7d911d-9ce4-4415-86ba-cf040740129b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106922f70>]}
[0m00:04:07.784876 [error] [Thread-1  ]: 1 of 1 ERROR creating sql incremental model default.events_streaming ........... [[31mERROR[0m in 0.13s]
[0m00:04:07.785261 [debug] [Thread-1  ]: Finished running node model.iceberg_project.events_streaming
[0m00:04:07.785618 [debug] [Thread-4  ]: Marking all children of 'model.iceberg_project.events_streaming' to be skipped because of status 'error'.  Reason: Database Error in model events_streaming (models/kafka_to_iceberg/events_streaming.sql)
  TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message="line 3:18: mismatched input '.'. Expecting: '='", query_id=20250318_040407_00012_j25rb)
  compiled code at target/run/iceberg_project/models/kafka_to_iceberg/events_streaming.sql.
[0m00:04:07.786300 [debug] [MainThread]: On master: COMMIT
[0m00:04:07.786531 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:04:07.786703 [debug] [MainThread]: Connection 'model.iceberg_project.events_streaming' was properly closed.
[0m00:04:07.786896 [info ] [MainThread]: 
[0m00:04:07.787099 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.62 seconds (0.62s).
[0m00:04:07.787487 [debug] [MainThread]: Command end result
[0m00:04:07.803184 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/target/manifest.json
[0m00:04:07.804365 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/target/semantic_manifest.json
[0m00:04:07.808285 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/target/run_results.json
[0m00:04:07.808530 [info ] [MainThread]: 
[0m00:04:07.808789 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m00:04:07.808999 [info ] [MainThread]: 
[0m00:04:07.809238 [error] [MainThread]:   Database Error in model events_streaming (models/kafka_to_iceberg/events_streaming.sql)
  TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message="line 3:18: mismatched input '.'. Expecting: '='", query_id=20250318_040407_00012_j25rb)
  compiled code at target/run/iceberg_project/models/kafka_to_iceberg/events_streaming.sql
[0m00:04:07.809435 [info ] [MainThread]: 
[0m00:04:07.809638 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m00:04:07.811024 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.5685297, "process_in_blocks": "0", "process_kernel_time": 0.198625, "process_mem_max_rss": "126124032", "process_out_blocks": "0", "process_user_time": 1.665579}
[0m00:04:07.811403 [debug] [MainThread]: Command `dbt run` failed at 00:04:07.811343 after 1.57 seconds
[0m00:04:07.811722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078555e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa8ef40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b4e760>]}
[0m00:04:07.811983 [debug] [MainThread]: Flushing usage events
[0m00:04:07.933214 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m00:06:37.511367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a11640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088c36a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088c3130>]}


============================== 00:06:37.514180 | 7937dd78-a94b-4c8d-8919-8bbf1aa96adb ==============================
[0m00:06:37.514180 [info ] [MainThread]: Running with dbt=1.9.3
[0m00:06:37.514584 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ankurchopra/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/logs', 'warn_error': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --models kafka_to_iceberg.events_streaming', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m00:06:37.704749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7937dd78-a94b-4c8d-8919-8bbf1aa96adb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a442e0>]}
[0m00:06:37.750281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7937dd78-a94b-4c8d-8919-8bbf1aa96adb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10886c880>]}
[0m00:06:37.750824 [info ] [MainThread]: Registered adapter: trino=1.8.5
[0m00:06:37.819685 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m00:06:37.896003 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m00:06:37.896336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7937dd78-a94b-4c8d-8919-8bbf1aa96adb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1083526a0>]}
[0m00:06:38.795720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7937dd78-a94b-4c8d-8919-8bbf1aa96adb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1094d2bb0>]}
[0m00:06:38.894809 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/target/manifest.json
[0m00:06:38.896502 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/target/semantic_manifest.json
[0m00:06:38.903320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7937dd78-a94b-4c8d-8919-8bbf1aa96adb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109227190>]}
[0m00:06:38.903649 [info ] [MainThread]: Found 5 models, 3 data tests, 1 source, 458 macros
[0m00:06:38.903860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7937dd78-a94b-4c8d-8919-8bbf1aa96adb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092da190>]}
[0m00:06:38.904533 [info ] [MainThread]: 
[0m00:06:38.904743 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m00:06:38.904918 [info ] [MainThread]: 
[0m00:06:38.905185 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m00:06:38.905633 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
[0m00:06:38.937278 [debug] [ThreadPool]: Using trino connection "list_iceberg"
[0m00:06:38.937566 [debug] [ThreadPool]: On list_iceberg: select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
/* dbt: dev */
[0m00:06:38.937743 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:06:38.937902 [warn ] [ThreadPool]: [[33mWARNING[0m]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.
You may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.
Visit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.
[0m00:06:38.938163 [debug] [ThreadPool]: Sending event: {'category': 'dbt', 'action': 'BehaviorChangeEvent', 'label': '7937dd78-a94b-4c8d-8919-8bbf1aa96adb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092074c0>]}
[0m00:06:39.133840 [debug] [ThreadPool]: SQL status: SUCCESS in 0.196 seconds
[0m00:06:39.134852 [debug] [ThreadPool]: On list_iceberg: Close
[0m00:06:39.138537 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_default)
[0m00:06:39.148499 [debug] [ThreadPool]: Using trino connection "list_iceberg_default"
[0m00:06:39.148848 [debug] [ThreadPool]: On list_iceberg_default: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'default') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'default'
/* dbt: dev */
[0m00:06:39.149056 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:06:39.380294 [debug] [ThreadPool]: SQL status: SUCCESS in 0.231 seconds
[0m00:06:39.381268 [debug] [ThreadPool]: On list_iceberg_default: ROLLBACK
[0m00:06:39.381495 [debug] [ThreadPool]: On list_iceberg_default: Close
[0m00:06:39.382431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7937dd78-a94b-4c8d-8919-8bbf1aa96adb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10929bd00>]}
[0m00:06:39.382842 [debug] [MainThread]: On master: COMMIT
[0m00:06:39.384382 [debug] [Thread-1  ]: Began running node model.iceberg_project.events_streaming
[0m00:06:39.384855 [info ] [Thread-1  ]: 1 of 1 START sql incremental model default.events_streaming .................... [RUN]
[0m00:06:39.385169 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_iceberg_default, now model.iceberg_project.events_streaming)
[0m00:06:39.385406 [debug] [Thread-1  ]: Began compiling node model.iceberg_project.events_streaming
[0m00:06:39.389617 [debug] [Thread-1  ]: Using trino connection "model.iceberg_project.events_streaming"
[0m00:06:39.389915 [debug] [Thread-1  ]: On model.iceberg_project.events_streaming: SELECT -1 as max_offset
/* dbt: dev */
[0m00:06:39.390135 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m00:06:39.421657 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.031 seconds
[0m00:06:39.422855 [debug] [Thread-1  ]: Writing injected SQL for node "model.iceberg_project.events_streaming"
[0m00:06:39.423707 [debug] [Thread-1  ]: Began executing node model.iceberg_project.events_streaming
[0m00:06:39.461912 [debug] [Thread-1  ]: Writing runtime sql for node "model.iceberg_project.events_streaming"
[0m00:06:39.464025 [debug] [Thread-1  ]: Using trino connection "model.iceberg_project.events_streaming"
[0m00:06:39.464294 [debug] [Thread-1  ]: On model.iceberg_project.events_streaming: create table "iceberg"."default"."events_streaming"
      
      
    as (
      







    


WITH kafka_data AS (
    SELECT
        CAST(JSON_EXTRACT_SCALAR(CAST(message AS VARCHAR), '$.id') AS BIGINT) AS id,
        JSON_EXTRACT_SCALAR(CAST(message AS VARCHAR), '$.name') AS name,
        CAST(JSON_EXTRACT_SCALAR(CAST(message AS VARCHAR), '$.created_at') AS TIMESTAMP(6)) AS created_at,
        _kafka_partition,
        _kafka_offset
    FROM "kafka"."default"."events_topic"
    
)

SELECT
    id,
    name,
    created_at,
    _kafka_partition,
    _kafka_offset,
    CAST(CURRENT_TIMESTAMP AS TIMESTAMP(6)) AS processed_at
FROM kafka_data
WHERE id IS NOT NULL
    )
/* dbt: dev */
[0m00:06:39.576343 [debug] [Thread-1  ]: Trino adapter: Trino query id: 20250318_040639_00016_j25rb
[0m00:06:39.576765 [debug] [Thread-1  ]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 18:39: Column 'message' cannot be resolved", query_id=20250318_040639_00016_j25rb)
[0m00:06:39.577081 [debug] [Thread-1  ]: On model.iceberg_project.events_streaming: ROLLBACK
[0m00:06:39.577307 [debug] [Thread-1  ]: On model.iceberg_project.events_streaming: Close
[0m00:06:39.582441 [debug] [Thread-1  ]: Database Error in model events_streaming (models/kafka_to_iceberg/events_streaming.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 18:39: Column 'message' cannot be resolved", query_id=20250318_040639_00016_j25rb)
  compiled code at target/run/iceberg_project/models/kafka_to_iceberg/events_streaming.sql
[0m00:06:39.584168 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7937dd78-a94b-4c8d-8919-8bbf1aa96adb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e85fa0>]}
[0m00:06:39.584676 [error] [Thread-1  ]: 1 of 1 ERROR creating sql incremental model default.events_streaming ........... [[31mERROR[0m in 0.20s]
[0m00:06:39.585197 [debug] [Thread-1  ]: Finished running node model.iceberg_project.events_streaming
[0m00:06:39.585723 [debug] [Thread-4  ]: Marking all children of 'model.iceberg_project.events_streaming' to be skipped because of status 'error'.  Reason: Database Error in model events_streaming (models/kafka_to_iceberg/events_streaming.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 18:39: Column 'message' cannot be resolved", query_id=20250318_040639_00016_j25rb)
  compiled code at target/run/iceberg_project/models/kafka_to_iceberg/events_streaming.sql.
[0m00:06:39.586546 [debug] [MainThread]: On master: COMMIT
[0m00:06:39.586796 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:06:39.586963 [debug] [MainThread]: Connection 'model.iceberg_project.events_streaming' was properly closed.
[0m00:06:39.587150 [info ] [MainThread]: 
[0m00:06:39.587341 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.68 seconds (0.68s).
[0m00:06:39.587737 [debug] [MainThread]: Command end result
[0m00:06:39.605860 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/target/manifest.json
[0m00:06:39.607130 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/target/semantic_manifest.json
[0m00:06:39.611180 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/target/run_results.json
[0m00:06:39.611449 [info ] [MainThread]: 
[0m00:06:39.611711 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m00:06:39.611985 [info ] [MainThread]: 
[0m00:06:39.612386 [error] [MainThread]:   Database Error in model events_streaming (models/kafka_to_iceberg/events_streaming.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 18:39: Column 'message' cannot be resolved", query_id=20250318_040639_00016_j25rb)
  compiled code at target/run/iceberg_project/models/kafka_to_iceberg/events_streaming.sql
[0m00:06:39.612602 [info ] [MainThread]: 
[0m00:06:39.612811 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m00:06:39.614198 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.153943, "process_in_blocks": "0", "process_kernel_time": 0.191076, "process_mem_max_rss": "129007616", "process_out_blocks": "0", "process_user_time": 2.168334}
[0m00:06:39.614699 [debug] [MainThread]: Command `dbt run` failed at 00:06:39.614612 after 2.15 seconds
[0m00:06:39.614984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a11640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092272e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d165b0>]}
[0m00:06:39.615237 [debug] [MainThread]: Flushing usage events
[0m00:06:39.779766 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:13:45.314125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047ed610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069a3640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069a3160>]}


============================== 13:13:45.317045 | 4f24c866-4d83-4599-a769-3aa3d55c27ad ==============================
[0m13:13:45.317045 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:13:45.317450 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ankurchopra/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/logs', 'fail_fast': 'False', 'warn_error': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --models kafka_to_iceberg.events_streaming', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:13:45.526114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4f24c866-4d83-4599-a769-3aa3d55c27ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1024cd2e0>]}
[0m13:13:45.570089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4f24c866-4d83-4599-a769-3aa3d55c27ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10657e6d0>]}
[0m13:13:45.570526 [info ] [MainThread]: Registered adapter: trino=1.8.5
[0m13:13:45.649420 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:13:45.751717 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:13:45.752209 [debug] [MainThread]: Partial parsing: updated file: iceberg_project://models/kafka_to_iceberg/events_streaming.sql
[0m13:13:46.099364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4f24c866-4d83-4599-a769-3aa3d55c27ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ab59a0>]}
[0m13:13:46.171411 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/target/manifest.json
[0m13:13:46.173266 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/target/semantic_manifest.json
[0m13:13:46.180520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4f24c866-4d83-4599-a769-3aa3d55c27ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dad700>]}
[0m13:13:46.180860 [info ] [MainThread]: Found 5 models, 3 data tests, 1 source, 458 macros
[0m13:13:46.181078 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f24c866-4d83-4599-a769-3aa3d55c27ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d6cb20>]}
[0m13:13:46.181795 [info ] [MainThread]: 
[0m13:13:46.182012 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:13:46.182186 [info ] [MainThread]: 
[0m13:13:46.182452 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m13:13:46.182907 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
[0m13:13:46.215971 [debug] [ThreadPool]: Using trino connection "list_iceberg"
[0m13:13:46.216265 [debug] [ThreadPool]: On list_iceberg: select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
/* dbt: dev */
[0m13:13:46.216445 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:13:46.216602 [warn ] [ThreadPool]: [[33mWARNING[0m]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.
You may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.
Visit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.
[0m13:13:46.216866 [debug] [ThreadPool]: Sending event: {'category': 'dbt', 'action': 'BehaviorChangeEvent', 'label': '4f24c866-4d83-4599-a769-3aa3d55c27ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107dbcd60>]}
[0m13:13:46.414092 [debug] [ThreadPool]: SQL status: SUCCESS in 0.198 seconds
[0m13:13:46.415098 [debug] [ThreadPool]: On list_iceberg: Close
[0m13:13:46.418719 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_default)
[0m13:13:46.429322 [debug] [ThreadPool]: Using trino connection "list_iceberg_default"
[0m13:13:46.429702 [debug] [ThreadPool]: On list_iceberg_default: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'default') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'default'
/* dbt: dev */
[0m13:13:46.429931 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:13:46.877385 [debug] [ThreadPool]: SQL status: SUCCESS in 0.447 seconds
[0m13:13:46.878391 [debug] [ThreadPool]: On list_iceberg_default: ROLLBACK
[0m13:13:46.878608 [debug] [ThreadPool]: On list_iceberg_default: Close
[0m13:13:46.879380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f24c866-4d83-4599-a769-3aa3d55c27ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cbcee0>]}
[0m13:13:46.879746 [debug] [MainThread]: On master: COMMIT
[0m13:13:46.881586 [debug] [Thread-1  ]: Began running node model.iceberg_project.events_streaming
[0m13:13:46.881944 [info ] [Thread-1  ]: 1 of 1 START sql incremental model default.events_streaming .................... [RUN]
[0m13:13:46.882213 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_iceberg_default, now model.iceberg_project.events_streaming)
[0m13:13:46.882433 [debug] [Thread-1  ]: Began compiling node model.iceberg_project.events_streaming
[0m13:13:46.886607 [debug] [Thread-1  ]: Using trino connection "model.iceberg_project.events_streaming"
[0m13:13:46.886922 [debug] [Thread-1  ]: On model.iceberg_project.events_streaming: SELECT -1 as max_offset
/* dbt: dev */
[0m13:13:46.887137 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:13:46.930612 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.043 seconds
[0m13:13:46.931781 [debug] [Thread-1  ]: Writing injected SQL for node "model.iceberg_project.events_streaming"
[0m13:13:46.932353 [debug] [Thread-1  ]: Began executing node model.iceberg_project.events_streaming
[0m13:13:46.970799 [debug] [Thread-1  ]: Writing runtime sql for node "model.iceberg_project.events_streaming"
[0m13:13:46.973187 [debug] [Thread-1  ]: Using trino connection "model.iceberg_project.events_streaming"
[0m13:13:46.973518 [debug] [Thread-1  ]: On model.iceberg_project.events_streaming: create table "iceberg"."default"."events_streaming"
      
      
    as (
      







    


WITH kafka_data AS (
    SELECT
        CAST(JSON_EXTRACT_SCALAR(CAST(_message AS VARCHAR), '$.id') AS BIGINT) AS id,
        JSON_EXTRACT_SCALAR(CAST(_message AS VARCHAR), '$.name') AS name,
        CAST(JSON_EXTRACT_SCALAR(CAST_message AS VARCHAR), '$.created_at') AS TIMESTAMP(6)) AS created_at,
        _kafka_partition,
        _kafka_offset
    FROM "kafka"."default"."events_topic"
    
)

SELECT
    id,
    name,
    created_at,
    _kafka_partition,
    _kafka_offset,
    CAST(CURRENT_TIMESTAMP AS TIMESTAMP(6)) AS processed_at
FROM kafka_data
WHERE id IS NOT NULL
    )
/* dbt: dev */
[0m13:13:46.988271 [debug] [Thread-1  ]: Trino adapter: Trino query id: 20250318_045732_00030_j25rb
[0m13:13:46.988673 [debug] [Thread-1  ]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message="line 20:47: mismatched input 'AS'. Expecting: ')', ',', '.', 'ORDER'", query_id=20250318_045732_00030_j25rb)
[0m13:13:46.989015 [debug] [Thread-1  ]: On model.iceberg_project.events_streaming: ROLLBACK
[0m13:13:46.989245 [debug] [Thread-1  ]: On model.iceberg_project.events_streaming: Close
[0m13:13:46.993681 [debug] [Thread-1  ]: Database Error in model events_streaming (models/kafka_to_iceberg/events_streaming.sql)
  TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message="line 20:47: mismatched input 'AS'. Expecting: ')', ',', '.', 'ORDER'", query_id=20250318_045732_00030_j25rb)
  compiled code at target/run/iceberg_project/models/kafka_to_iceberg/events_streaming.sql
[0m13:13:46.995141 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4f24c866-4d83-4599-a769-3aa3d55c27ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d0d280>]}
[0m13:13:46.995674 [error] [Thread-1  ]: 1 of 1 ERROR creating sql incremental model default.events_streaming ........... [[31mERROR[0m in 0.11s]
[0m13:13:46.996039 [debug] [Thread-1  ]: Finished running node model.iceberg_project.events_streaming
[0m13:13:46.996438 [debug] [Thread-4  ]: Marking all children of 'model.iceberg_project.events_streaming' to be skipped because of status 'error'.  Reason: Database Error in model events_streaming (models/kafka_to_iceberg/events_streaming.sql)
  TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message="line 20:47: mismatched input 'AS'. Expecting: ')', ',', '.', 'ORDER'", query_id=20250318_045732_00030_j25rb)
  compiled code at target/run/iceberg_project/models/kafka_to_iceberg/events_streaming.sql.
[0m13:13:46.997173 [debug] [MainThread]: On master: COMMIT
[0m13:13:46.997434 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:13:46.997622 [debug] [MainThread]: Connection 'model.iceberg_project.events_streaming' was properly closed.
[0m13:13:46.997828 [info ] [MainThread]: 
[0m13:13:46.998034 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.82 seconds (0.82s).
[0m13:13:46.998437 [debug] [MainThread]: Command end result
[0m13:13:47.013708 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/target/manifest.json
[0m13:13:47.014721 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/target/semantic_manifest.json
[0m13:13:47.018685 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/target/run_results.json
[0m13:13:47.018941 [info ] [MainThread]: 
[0m13:13:47.019238 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:13:47.019453 [info ] [MainThread]: 
[0m13:13:47.019691 [error] [MainThread]:   Database Error in model events_streaming (models/kafka_to_iceberg/events_streaming.sql)
  TrinoUserError(type=USER_ERROR, name=SYNTAX_ERROR, message="line 20:47: mismatched input 'AS'. Expecting: ')', ',', '.', 'ORDER'", query_id=20250318_045732_00030_j25rb)
  compiled code at target/run/iceberg_project/models/kafka_to_iceberg/events_streaming.sql
[0m13:13:47.019882 [info ] [MainThread]: 
[0m13:13:47.020087 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:13:47.036169 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.775626, "process_in_blocks": "0", "process_kernel_time": 0.221102, "process_mem_max_rss": "125976576", "process_out_blocks": "0", "process_user_time": 1.652119}
[0m13:13:47.036619 [debug] [MainThread]: Command `dbt run` failed at 13:13:47.036561 after 1.78 seconds
[0m13:13:47.036872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047ed610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10595b910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10657e6d0>]}
[0m13:13:47.037112 [debug] [MainThread]: Flushing usage events
[0m13:13:47.231055 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:15:42.222063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103869610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10471b640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10471b160>]}


============================== 13:15:42.225222 | 924439a2-605a-46bc-9b3b-37b5ba5852d5 ==============================
[0m13:15:42.225222 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:15:42.225609 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ankurchopra/.dbt', 'version_check': 'True', 'warn_error': 'False', 'log_path': '/Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --models kafka_to_iceberg.events_streaming', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:15:42.426327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '924439a2-605a-46bc-9b3b-37b5ba5852d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10289d2e0>]}
[0m13:15:42.472989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '924439a2-605a-46bc-9b3b-37b5ba5852d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1042f66d0>]}
[0m13:15:42.473823 [info ] [MainThread]: Registered adapter: trino=1.8.5
[0m13:15:42.544434 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:15:42.654718 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:15:42.655273 [debug] [MainThread]: Partial parsing: updated file: iceberg_project://models/kafka_to_iceberg/events_streaming.sql
[0m13:15:43.013306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '924439a2-605a-46bc-9b3b-37b5ba5852d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049e4190>]}
[0m13:15:43.086894 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/target/manifest.json
[0m13:15:43.088448 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/target/semantic_manifest.json
[0m13:15:43.095141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '924439a2-605a-46bc-9b3b-37b5ba5852d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104eb2e20>]}
[0m13:15:43.095474 [info ] [MainThread]: Found 5 models, 3 data tests, 1 source, 458 macros
[0m13:15:43.095693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '924439a2-605a-46bc-9b3b-37b5ba5852d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e8c610>]}
[0m13:15:43.096391 [info ] [MainThread]: 
[0m13:15:43.096613 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:15:43.096794 [info ] [MainThread]: 
[0m13:15:43.097067 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m13:15:43.097528 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
[0m13:15:43.129190 [debug] [ThreadPool]: Using trino connection "list_iceberg"
[0m13:15:43.129498 [debug] [ThreadPool]: On list_iceberg: select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
/* dbt: dev */
[0m13:15:43.129686 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:15:43.129861 [warn ] [ThreadPool]: [[33mWARNING[0m]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.
You may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.
Visit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.
[0m13:15:43.130141 [debug] [ThreadPool]: Sending event: {'category': 'dbt', 'action': 'BehaviorChangeEvent', 'label': '924439a2-605a-46bc-9b3b-37b5ba5852d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052bc250>]}
[0m13:15:43.305493 [debug] [ThreadPool]: SQL status: SUCCESS in 0.176 seconds
[0m13:15:43.306493 [debug] [ThreadPool]: On list_iceberg: Close
[0m13:15:43.310005 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_default)
[0m13:15:43.320014 [debug] [ThreadPool]: Using trino connection "list_iceberg_default"
[0m13:15:43.320706 [debug] [ThreadPool]: On list_iceberg_default: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'default') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'default'
/* dbt: dev */
[0m13:15:43.321065 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:15:43.560050 [debug] [ThreadPool]: SQL status: SUCCESS in 0.239 seconds
[0m13:15:43.561091 [debug] [ThreadPool]: On list_iceberg_default: ROLLBACK
[0m13:15:43.561421 [debug] [ThreadPool]: On list_iceberg_default: Close
[0m13:15:43.562528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '924439a2-605a-46bc-9b3b-37b5ba5852d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049bbee0>]}
[0m13:15:43.562903 [debug] [MainThread]: On master: COMMIT
[0m13:15:43.564576 [debug] [Thread-1  ]: Began running node model.iceberg_project.events_streaming
[0m13:15:43.564948 [info ] [Thread-1  ]: 1 of 1 START sql incremental model default.events_streaming .................... [RUN]
[0m13:15:43.565368 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_iceberg_default, now model.iceberg_project.events_streaming)
[0m13:15:43.565616 [debug] [Thread-1  ]: Began compiling node model.iceberg_project.events_streaming
[0m13:15:43.569768 [debug] [Thread-1  ]: Using trino connection "model.iceberg_project.events_streaming"
[0m13:15:43.570137 [debug] [Thread-1  ]: On model.iceberg_project.events_streaming: SELECT -1 as max_offset
/* dbt: dev */
[0m13:15:43.570356 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:15:43.623939 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.054 seconds
[0m13:15:43.625081 [debug] [Thread-1  ]: Writing injected SQL for node "model.iceberg_project.events_streaming"
[0m13:15:43.625567 [debug] [Thread-1  ]: Began executing node model.iceberg_project.events_streaming
[0m13:15:43.662485 [debug] [Thread-1  ]: Writing runtime sql for node "model.iceberg_project.events_streaming"
[0m13:15:43.664841 [debug] [Thread-1  ]: Using trino connection "model.iceberg_project.events_streaming"
[0m13:15:43.665122 [debug] [Thread-1  ]: On model.iceberg_project.events_streaming: create table "iceberg"."default"."events_streaming"
      
      
    as (
      







    


WITH kafka_data AS (
    SELECT
        CAST(JSON_EXTRACT_SCALAR(CAST(message AS VARCHAR), '$.id') AS BIGINT) AS id,
        JSON_EXTRACT_SCALAR(CAST(message AS VARCHAR), '$.name') AS name,
        CAST(JSON_EXTRACT_SCALAR(CAST(message AS VARCHAR), '$.created_at') AS TIMESTAMP(6)) AS created_at,
        _kafka_partition,
        _kafka_offset
    FROM "kafka"."default"."events_topic"
    
)

SELECT
    id,
    name,
    created_at,
    _kafka_partition,
    _kafka_offset,
    CAST(CURRENT_TIMESTAMP AS TIMESTAMP(6)) AS processed_at
FROM kafka_data
WHERE id IS NOT NULL
    )
/* dbt: dev */
[0m13:15:43.693516 [debug] [Thread-1  ]: Trino adapter: Trino query id: 20250318_045929_00034_j25rb
[0m13:15:43.693906 [debug] [Thread-1  ]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 18:39: Column 'message' cannot be resolved", query_id=20250318_045929_00034_j25rb)
[0m13:15:43.694224 [debug] [Thread-1  ]: On model.iceberg_project.events_streaming: ROLLBACK
[0m13:15:43.694544 [debug] [Thread-1  ]: On model.iceberg_project.events_streaming: Close
[0m13:15:43.699529 [debug] [Thread-1  ]: Database Error in model events_streaming (models/kafka_to_iceberg/events_streaming.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 18:39: Column 'message' cannot be resolved", query_id=20250318_045929_00034_j25rb)
  compiled code at target/run/iceberg_project/models/kafka_to_iceberg/events_streaming.sql
[0m13:15:43.701224 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '924439a2-605a-46bc-9b3b-37b5ba5852d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10577c0d0>]}
[0m13:15:43.701784 [error] [Thread-1  ]: 1 of 1 ERROR creating sql incremental model default.events_streaming ........... [[31mERROR[0m in 0.13s]
[0m13:15:43.702180 [debug] [Thread-1  ]: Finished running node model.iceberg_project.events_streaming
[0m13:15:43.702545 [debug] [Thread-4  ]: Marking all children of 'model.iceberg_project.events_streaming' to be skipped because of status 'error'.  Reason: Database Error in model events_streaming (models/kafka_to_iceberg/events_streaming.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 18:39: Column 'message' cannot be resolved", query_id=20250318_045929_00034_j25rb)
  compiled code at target/run/iceberg_project/models/kafka_to_iceberg/events_streaming.sql.
[0m13:15:43.703245 [debug] [MainThread]: On master: COMMIT
[0m13:15:43.703475 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:15:43.703655 [debug] [MainThread]: Connection 'model.iceberg_project.events_streaming' was properly closed.
[0m13:15:43.703977 [info ] [MainThread]: 
[0m13:15:43.704314 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.61 seconds (0.61s).
[0m13:15:43.704799 [debug] [MainThread]: Command end result
[0m13:15:43.722258 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/target/manifest.json
[0m13:15:43.723495 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/target/semantic_manifest.json
[0m13:15:43.727087 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/target/run_results.json
[0m13:15:43.727295 [info ] [MainThread]: 
[0m13:15:43.727526 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:15:43.727725 [info ] [MainThread]: 
[0m13:15:43.727957 [error] [MainThread]:   Database Error in model events_streaming (models/kafka_to_iceberg/events_streaming.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 18:39: Column 'message' cannot be resolved", query_id=20250318_045929_00034_j25rb)
  compiled code at target/run/iceberg_project/models/kafka_to_iceberg/events_streaming.sql
[0m13:15:43.728144 [info ] [MainThread]: 
[0m13:15:43.728331 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:15:43.729780 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.5634825, "process_in_blocks": "0", "process_kernel_time": 0.196003, "process_mem_max_rss": "126287872", "process_out_blocks": "0", "process_user_time": 1.654687}
[0m13:15:43.730236 [debug] [MainThread]: Command `dbt run` failed at 13:15:43.730167 after 1.56 seconds
[0m13:15:43.730518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103869610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104eb24c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1039e8e80>]}
[0m13:15:43.730780 [debug] [MainThread]: Flushing usage events
[0m13:15:43.899563 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:15:58.162572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f65640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061236a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106123130>]}


============================== 13:15:58.165429 | 36d1c49a-7464-42fe-ab73-a7a761fe9159 ==============================
[0m13:15:58.165429 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:15:58.165805 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'False', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/logs', 'version_check': 'True', 'profiles_dir': '/Users/ankurchopra/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run --models kafka_to_iceberg.events_streaming', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:15:58.311273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '36d1c49a-7464-42fe-ab73-a7a761fe9159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1024b92e0>]}
[0m13:15:58.356104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '36d1c49a-7464-42fe-ab73-a7a761fe9159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f5bb80>]}
[0m13:15:58.356640 [info ] [MainThread]: Registered adapter: trino=1.8.5
[0m13:15:58.430011 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:15:58.525599 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:15:58.526057 [debug] [MainThread]: Partial parsing: updated file: iceberg_project://models/kafka_to_iceberg/events_streaming.sql
[0m13:15:58.866757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '36d1c49a-7464-42fe-ab73-a7a761fe9159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10720cc40>]}
[0m13:15:58.934365 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/target/manifest.json
[0m13:15:58.935589 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/target/semantic_manifest.json
[0m13:15:58.941252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '36d1c49a-7464-42fe-ab73-a7a761fe9159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107326eb0>]}
[0m13:15:58.941574 [info ] [MainThread]: Found 5 models, 3 data tests, 1 source, 458 macros
[0m13:15:58.941788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '36d1c49a-7464-42fe-ab73-a7a761fe9159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075abdc0>]}
[0m13:15:58.942445 [info ] [MainThread]: 
[0m13:15:58.942655 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:15:58.942841 [info ] [MainThread]: 
[0m13:15:58.943104 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m13:15:58.943577 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
[0m13:15:58.972609 [debug] [ThreadPool]: Using trino connection "list_iceberg"
[0m13:15:58.972902 [debug] [ThreadPool]: On list_iceberg: select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
/* dbt: dev */
[0m13:15:58.973083 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:15:58.973245 [warn ] [ThreadPool]: [[33mWARNING[0m]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.
You may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.
Visit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.
[0m13:15:58.973512 [debug] [ThreadPool]: Sending event: {'category': 'dbt', 'action': 'BehaviorChangeEvent', 'label': '36d1c49a-7464-42fe-ab73-a7a761fe9159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1075fde80>]}
[0m13:15:59.068875 [debug] [ThreadPool]: SQL status: SUCCESS in 0.096 seconds
[0m13:15:59.069779 [debug] [ThreadPool]: On list_iceberg: Close
[0m13:15:59.073491 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_default)
[0m13:15:59.083256 [debug] [ThreadPool]: Using trino connection "list_iceberg_default"
[0m13:15:59.083592 [debug] [ThreadPool]: On list_iceberg_default: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'default') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'default'
/* dbt: dev */
[0m13:15:59.083808 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:15:59.278111 [debug] [ThreadPool]: SQL status: SUCCESS in 0.194 seconds
[0m13:15:59.279122 [debug] [ThreadPool]: On list_iceberg_default: ROLLBACK
[0m13:15:59.279339 [debug] [ThreadPool]: On list_iceberg_default: Close
[0m13:15:59.280180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '36d1c49a-7464-42fe-ab73-a7a761fe9159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1023d8160>]}
[0m13:15:59.280550 [debug] [MainThread]: On master: COMMIT
[0m13:15:59.282022 [debug] [Thread-1  ]: Began running node model.iceberg_project.events_streaming
[0m13:15:59.282425 [info ] [Thread-1  ]: 1 of 1 START sql incremental model default.events_streaming .................... [RUN]
[0m13:15:59.282712 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_iceberg_default, now model.iceberg_project.events_streaming)
[0m13:15:59.282945 [debug] [Thread-1  ]: Began compiling node model.iceberg_project.events_streaming
[0m13:15:59.287059 [debug] [Thread-1  ]: Using trino connection "model.iceberg_project.events_streaming"
[0m13:15:59.287349 [debug] [Thread-1  ]: On model.iceberg_project.events_streaming: SELECT -1 as max_offset
/* dbt: dev */
[0m13:15:59.287573 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:15:59.317952 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.030 seconds
[0m13:15:59.319120 [debug] [Thread-1  ]: Writing injected SQL for node "model.iceberg_project.events_streaming"
[0m13:15:59.319672 [debug] [Thread-1  ]: Began executing node model.iceberg_project.events_streaming
[0m13:15:59.356387 [debug] [Thread-1  ]: Writing runtime sql for node "model.iceberg_project.events_streaming"
[0m13:15:59.358775 [debug] [Thread-1  ]: Using trino connection "model.iceberg_project.events_streaming"
[0m13:15:59.359173 [debug] [Thread-1  ]: On model.iceberg_project.events_streaming: create table "iceberg"."default"."events_streaming"
      
      
    as (
      







    


WITH kafka_data AS (
    SELECT
        CAST(JSON_EXTRACT_SCALAR(CAST(_message AS VARCHAR), '$.id') AS BIGINT) AS id,
        JSON_EXTRACT_SCALAR(CAST(_message AS VARCHAR), '$.name') AS name,
        CAST(JSON_EXTRACT_SCALAR(CAST(_message AS VARCHAR), '$.created_at') AS TIMESTAMP(6)) AS created_at,
        _kafka_partition,
        _kafka_offset
    FROM "kafka"."default"."events_topic"
    
)

SELECT
    id,
    name,
    created_at,
    _kafka_partition,
    _kafka_offset,
    CAST(CURRENT_TIMESTAMP AS TIMESTAMP(6)) AS processed_at
FROM kafka_data
WHERE id IS NOT NULL
    )
/* dbt: dev */
[0m13:15:59.387143 [debug] [Thread-1  ]: Trino adapter: Trino query id: 20250318_045945_00038_j25rb
[0m13:15:59.387555 [debug] [Thread-1  ]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 21:9: Column '_kafka_partition' cannot be resolved", query_id=20250318_045945_00038_j25rb)
[0m13:15:59.387874 [debug] [Thread-1  ]: On model.iceberg_project.events_streaming: ROLLBACK
[0m13:15:59.388090 [debug] [Thread-1  ]: On model.iceberg_project.events_streaming: Close
[0m13:15:59.392318 [debug] [Thread-1  ]: Database Error in model events_streaming (models/kafka_to_iceberg/events_streaming.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 21:9: Column '_kafka_partition' cannot be resolved", query_id=20250318_045945_00038_j25rb)
  compiled code at target/run/iceberg_project/models/kafka_to_iceberg/events_streaming.sql
[0m13:15:59.393696 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '36d1c49a-7464-42fe-ab73-a7a761fe9159', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bbc0d0>]}
[0m13:15:59.394190 [error] [Thread-1  ]: 1 of 1 ERROR creating sql incremental model default.events_streaming ........... [[31mERROR[0m in 0.11s]
[0m13:15:59.394569 [debug] [Thread-1  ]: Finished running node model.iceberg_project.events_streaming
[0m13:15:59.394908 [debug] [Thread-4  ]: Marking all children of 'model.iceberg_project.events_streaming' to be skipped because of status 'error'.  Reason: Database Error in model events_streaming (models/kafka_to_iceberg/events_streaming.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 21:9: Column '_kafka_partition' cannot be resolved", query_id=20250318_045945_00038_j25rb)
  compiled code at target/run/iceberg_project/models/kafka_to_iceberg/events_streaming.sql.
[0m13:15:59.395525 [debug] [MainThread]: On master: COMMIT
[0m13:15:59.395759 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:15:59.395933 [debug] [MainThread]: Connection 'model.iceberg_project.events_streaming' was properly closed.
[0m13:15:59.396124 [info ] [MainThread]: 
[0m13:15:59.396319 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.45 seconds (0.45s).
[0m13:15:59.396708 [debug] [MainThread]: Command end result
[0m13:15:59.411509 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/target/manifest.json
[0m13:15:59.412454 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/target/semantic_manifest.json
[0m13:15:59.416288 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/target/run_results.json
[0m13:15:59.416519 [info ] [MainThread]: 
[0m13:15:59.416773 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:15:59.416982 [info ] [MainThread]: 
[0m13:15:59.417228 [error] [MainThread]:   Database Error in model events_streaming (models/kafka_to_iceberg/events_streaming.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 21:9: Column '_kafka_partition' cannot be resolved", query_id=20250318_045945_00038_j25rb)
  compiled code at target/run/iceberg_project/models/kafka_to_iceberg/events_streaming.sql
[0m13:15:59.417432 [info ] [MainThread]: 
[0m13:15:59.417637 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:15:59.418961 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.3078778, "process_in_blocks": "0", "process_kernel_time": 0.174036, "process_mem_max_rss": "126697472", "process_out_blocks": "0", "process_user_time": 1.602441}
[0m13:15:59.419277 [debug] [MainThread]: Command `dbt run` failed at 13:15:59.419227 after 1.31 seconds
[0m13:15:59.419520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103f65640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10425ec10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040eae80>]}
[0m13:15:59.419760 [debug] [MainThread]: Flushing usage events
[0m13:15:59.532903 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:16:42.652788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103cb9640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b6b6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b6b130>]}


============================== 13:16:42.655854 | e030d32f-015a-4c18-934a-fbcbd4facb2e ==============================
[0m13:16:42.655854 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:16:42.656244 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'False', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/logs', 'debug': 'False', 'profiles_dir': '/Users/ankurchopra/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --models kafka_to_iceberg.events_streaming', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:16:42.854483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e030d32f-015a-4c18-934a-fbcbd4facb2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102cec2e0>]}
[0m13:16:42.900459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e030d32f-015a-4c18-934a-fbcbd4facb2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b13880>]}
[0m13:16:42.901043 [info ] [MainThread]: Registered adapter: trino=1.8.5
[0m13:16:42.970191 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:16:43.071483 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:16:43.071960 [debug] [MainThread]: Partial parsing: updated file: iceberg_project://models/kafka_to_iceberg/events_streaming.sql
[0m13:16:43.422143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e030d32f-015a-4c18-934a-fbcbd4facb2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053d5940>]}
[0m13:16:43.490030 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/target/manifest.json
[0m13:16:43.491245 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/target/semantic_manifest.json
[0m13:16:43.497715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e030d32f-015a-4c18-934a-fbcbd4facb2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052e0a60>]}
[0m13:16:43.498036 [info ] [MainThread]: Found 5 models, 3 data tests, 1 source, 458 macros
[0m13:16:43.498255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e030d32f-015a-4c18-934a-fbcbd4facb2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055bcdc0>]}
[0m13:16:43.498941 [info ] [MainThread]: 
[0m13:16:43.499162 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:16:43.499346 [info ] [MainThread]: 
[0m13:16:43.499616 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m13:16:43.500085 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
[0m13:16:43.529713 [debug] [ThreadPool]: Using trino connection "list_iceberg"
[0m13:16:43.530013 [debug] [ThreadPool]: On list_iceberg: select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
/* dbt: dev */
[0m13:16:43.530189 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:16:43.530635 [warn ] [ThreadPool]: [[33mWARNING[0m]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.
You may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.
Visit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.
[0m13:16:43.530953 [debug] [ThreadPool]: Sending event: {'category': 'dbt', 'action': 'BehaviorChangeEvent', 'label': 'e030d32f-015a-4c18-934a-fbcbd4facb2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10593fdc0>]}
[0m13:16:43.710267 [debug] [ThreadPool]: SQL status: SUCCESS in 0.180 seconds
[0m13:16:43.711175 [debug] [ThreadPool]: On list_iceberg: Close
[0m13:16:43.714859 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_default)
[0m13:16:43.725813 [debug] [ThreadPool]: Using trino connection "list_iceberg_default"
[0m13:16:43.726188 [debug] [ThreadPool]: On list_iceberg_default: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'default') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'default'
/* dbt: dev */
[0m13:16:43.726422 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:16:43.901108 [debug] [ThreadPool]: SQL status: SUCCESS in 0.175 seconds
[0m13:16:43.902050 [debug] [ThreadPool]: On list_iceberg_default: ROLLBACK
[0m13:16:43.902265 [debug] [ThreadPool]: On list_iceberg_default: Close
[0m13:16:43.903075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e030d32f-015a-4c18-934a-fbcbd4facb2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102c0c160>]}
[0m13:16:43.903422 [debug] [MainThread]: On master: COMMIT
[0m13:16:43.905173 [debug] [Thread-1  ]: Began running node model.iceberg_project.events_streaming
[0m13:16:43.905513 [info ] [Thread-1  ]: 1 of 1 START sql incremental model default.events_streaming .................... [RUN]
[0m13:16:43.905772 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_iceberg_default, now model.iceberg_project.events_streaming)
[0m13:16:43.905994 [debug] [Thread-1  ]: Began compiling node model.iceberg_project.events_streaming
[0m13:16:43.910029 [debug] [Thread-1  ]: Using trino connection "model.iceberg_project.events_streaming"
[0m13:16:43.910277 [debug] [Thread-1  ]: On model.iceberg_project.events_streaming: SELECT -1 as max_offset
/* dbt: dev */
[0m13:16:43.910480 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:16:43.946958 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.036 seconds
[0m13:16:43.948043 [debug] [Thread-1  ]: Writing injected SQL for node "model.iceberg_project.events_streaming"
[0m13:16:43.948516 [debug] [Thread-1  ]: Began executing node model.iceberg_project.events_streaming
[0m13:16:43.986105 [debug] [Thread-1  ]: Writing runtime sql for node "model.iceberg_project.events_streaming"
[0m13:16:43.988411 [debug] [Thread-1  ]: Using trino connection "model.iceberg_project.events_streaming"
[0m13:16:43.988771 [debug] [Thread-1  ]: On model.iceberg_project.events_streaming: create table "iceberg"."default"."events_streaming"
      
      
    as (
      







    


WITH kafka_data AS (
    SELECT
        CAST(JSON_EXTRACT_SCALAR(CAST(_message AS VARCHAR), '$.id') AS BIGINT) AS id,
        JSON_EXTRACT_SCALAR(CAST(_message AS VARCHAR), '$.name') AS name,
        CAST(JSON_EXTRACT_SCALAR(CAST(_message AS VARCHAR), '$.created_at') AS TIMESTAMP(6)) AS created_at,
        _partition_id,
        _partition_offset
    FROM "kafka"."default"."events_topic"
    
)

SELECT
    id,
    name,
    created_at,
    _kafka_partition,
    _kafka_offset,
    CAST(CURRENT_TIMESTAMP AS TIMESTAMP(6)) AS processed_at
FROM kafka_data
WHERE id IS NOT NULL
    )
/* dbt: dev */
[0m13:16:44.017791 [debug] [Thread-1  ]: Trino adapter: Trino query id: 20250318_050029_00042_j25rb
[0m13:16:44.018180 [debug] [Thread-1  ]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 31:5: Column '_kafka_partition' cannot be resolved", query_id=20250318_050029_00042_j25rb)
[0m13:16:44.018492 [debug] [Thread-1  ]: On model.iceberg_project.events_streaming: ROLLBACK
[0m13:16:44.018705 [debug] [Thread-1  ]: On model.iceberg_project.events_streaming: Close
[0m13:16:44.023344 [debug] [Thread-1  ]: Database Error in model events_streaming (models/kafka_to_iceberg/events_streaming.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 31:5: Column '_kafka_partition' cannot be resolved", query_id=20250318_050029_00042_j25rb)
  compiled code at target/run/iceberg_project/models/kafka_to_iceberg/events_streaming.sql
[0m13:16:44.024768 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e030d32f-015a-4c18-934a-fbcbd4facb2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105df80d0>]}
[0m13:16:44.025241 [error] [Thread-1  ]: 1 of 1 ERROR creating sql incremental model default.events_streaming ........... [[31mERROR[0m in 0.12s]
[0m13:16:44.025614 [debug] [Thread-1  ]: Finished running node model.iceberg_project.events_streaming
[0m13:16:44.026086 [debug] [Thread-4  ]: Marking all children of 'model.iceberg_project.events_streaming' to be skipped because of status 'error'.  Reason: Database Error in model events_streaming (models/kafka_to_iceberg/events_streaming.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 31:5: Column '_kafka_partition' cannot be resolved", query_id=20250318_050029_00042_j25rb)
  compiled code at target/run/iceberg_project/models/kafka_to_iceberg/events_streaming.sql.
[0m13:16:44.026763 [debug] [MainThread]: On master: COMMIT
[0m13:16:44.026985 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:16:44.027153 [debug] [MainThread]: Connection 'model.iceberg_project.events_streaming' was properly closed.
[0m13:16:44.027341 [info ] [MainThread]: 
[0m13:16:44.027539 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.53 seconds (0.53s).
[0m13:16:44.027938 [debug] [MainThread]: Command end result
[0m13:16:44.043619 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/target/manifest.json
[0m13:16:44.044734 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/target/semantic_manifest.json
[0m13:16:44.048417 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/target/run_results.json
[0m13:16:44.048635 [info ] [MainThread]: 
[0m13:16:44.048879 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:16:44.049085 [info ] [MainThread]: 
[0m13:16:44.049326 [error] [MainThread]:   Database Error in model events_streaming (models/kafka_to_iceberg/events_streaming.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 31:5: Column '_kafka_partition' cannot be resolved", query_id=20250318_050029_00042_j25rb)
  compiled code at target/run/iceberg_project/models/kafka_to_iceberg/events_streaming.sql
[0m13:16:44.049523 [info ] [MainThread]: 
[0m13:16:44.049720 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:16:44.051083 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.4546664, "process_in_blocks": "0", "process_kernel_time": 0.186148, "process_mem_max_rss": "125632512", "process_out_blocks": "0", "process_user_time": 1.631472}
[0m13:16:44.051377 [debug] [MainThread]: Command `dbt run` failed at 13:16:44.051329 after 1.46 seconds
[0m13:16:44.051621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103cb9640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105589f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052e07f0>]}
[0m13:16:44.051849 [debug] [MainThread]: Flushing usage events
[0m13:16:44.170059 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:17:12.722381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f66580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a823580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a823130>]}


============================== 13:17:12.726195 | 5c029794-bfcc-4904-8ea0-f2b2b18fc6fe ==============================
[0m13:17:12.726195 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:17:12.726653 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'False', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/logs', 'profiles_dir': '/Users/ankurchopra/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --models kafka_to_iceberg.events_streaming', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:17:12.889128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5c029794-bfcc-4904-8ea0-f2b2b18fc6fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aac0fa0>]}
[0m13:17:12.932753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5c029794-bfcc-4904-8ea0-f2b2b18fc6fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aafafa0>]}
[0m13:17:12.933215 [info ] [MainThread]: Registered adapter: trino=1.8.5
[0m13:17:13.003390 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:17:13.101196 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:17:13.101706 [debug] [MainThread]: Partial parsing: updated file: iceberg_project://models/kafka_to_iceberg/events_streaming.sql
[0m13:17:13.447359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5c029794-bfcc-4904-8ea0-f2b2b18fc6fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109b160a0>]}
[0m13:17:13.516028 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/target/manifest.json
[0m13:17:13.518319 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/target/semantic_manifest.json
[0m13:17:13.524450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5c029794-bfcc-4904-8ea0-f2b2b18fc6fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b09f7c0>]}
[0m13:17:13.524777 [info ] [MainThread]: Found 5 models, 3 data tests, 1 source, 458 macros
[0m13:17:13.525009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c029794-bfcc-4904-8ea0-f2b2b18fc6fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b59a310>]}
[0m13:17:13.525696 [info ] [MainThread]: 
[0m13:17:13.525982 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:17:13.526166 [info ] [MainThread]: 
[0m13:17:13.526437 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m13:17:13.526919 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
[0m13:17:13.557674 [debug] [ThreadPool]: Using trino connection "list_iceberg"
[0m13:17:13.557970 [debug] [ThreadPool]: On list_iceberg: select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
/* dbt: dev */
[0m13:17:13.558165 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:17:13.558344 [warn ] [ThreadPool]: [[33mWARNING[0m]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.
You may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.
Visit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.
[0m13:17:13.558643 [debug] [ThreadPool]: Sending event: {'category': 'dbt', 'action': 'BehaviorChangeEvent', 'label': '5c029794-bfcc-4904-8ea0-f2b2b18fc6fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b56edc0>]}
[0m13:17:13.754713 [debug] [ThreadPool]: SQL status: SUCCESS in 0.196 seconds
[0m13:17:13.755601 [debug] [ThreadPool]: On list_iceberg: Close
[0m13:17:13.759182 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_default)
[0m13:17:13.769028 [debug] [ThreadPool]: Using trino connection "list_iceberg_default"
[0m13:17:13.769394 [debug] [ThreadPool]: On list_iceberg_default: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'default') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'default'
/* dbt: dev */
[0m13:17:13.769619 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:17:13.969065 [debug] [ThreadPool]: SQL status: SUCCESS in 0.199 seconds
[0m13:17:13.970082 [debug] [ThreadPool]: On list_iceberg_default: ROLLBACK
[0m13:17:13.970304 [debug] [ThreadPool]: On list_iceberg_default: Close
[0m13:17:13.971195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5c029794-bfcc-4904-8ea0-f2b2b18fc6fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b2dc040>]}
[0m13:17:13.971662 [debug] [MainThread]: On master: COMMIT
[0m13:17:13.973281 [debug] [Thread-1  ]: Began running node model.iceberg_project.events_streaming
[0m13:17:13.973682 [info ] [Thread-1  ]: 1 of 1 START sql incremental model default.events_streaming .................... [RUN]
[0m13:17:13.973967 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_iceberg_default, now model.iceberg_project.events_streaming)
[0m13:17:13.974203 [debug] [Thread-1  ]: Began compiling node model.iceberg_project.events_streaming
[0m13:17:13.978099 [debug] [Thread-1  ]: Using trino connection "model.iceberg_project.events_streaming"
[0m13:17:13.978347 [debug] [Thread-1  ]: On model.iceberg_project.events_streaming: SELECT -1 as max_offset
/* dbt: dev */
[0m13:17:13.978550 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:17:14.014037 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.035 seconds
[0m13:17:14.015106 [debug] [Thread-1  ]: Writing injected SQL for node "model.iceberg_project.events_streaming"
[0m13:17:14.015587 [debug] [Thread-1  ]: Began executing node model.iceberg_project.events_streaming
[0m13:17:14.052678 [debug] [Thread-1  ]: Writing runtime sql for node "model.iceberg_project.events_streaming"
[0m13:17:14.054683 [debug] [Thread-1  ]: Using trino connection "model.iceberg_project.events_streaming"
[0m13:17:14.054948 [debug] [Thread-1  ]: On model.iceberg_project.events_streaming: create table "iceberg"."default"."events_streaming"
      
      
    as (
      







    


WITH kafka_data AS (
    SELECT
        CAST(JSON_EXTRACT_SCALAR(CAST(_message AS VARCHAR), '$.id') AS BIGINT) AS id,
        JSON_EXTRACT_SCALAR(CAST(_message AS VARCHAR), '$.name') AS name,
        CAST(JSON_EXTRACT_SCALAR(CAST(_message AS VARCHAR), '$.created_at') AS TIMESTAMP(6)) AS created_at,
        _partition_id,
        _partition_offset
    FROM "kafka"."default"."events_topic"
    
)

SELECT
    id,
    name,
    created_at,
    _partition_id,
    _partition_offset,
    CAST(CURRENT_TIMESTAMP AS TIMESTAMP(6)) AS processed_at
FROM kafka_data
WHERE id IS NOT NULL
    )
/* dbt: dev */
[0m13:17:16.228006 [debug] [Thread-1  ]: SQL status: CREATE TABLE (5 rows) in 2.173 seconds
[0m13:17:16.233262 [debug] [Thread-1  ]: Applying DROP to: "iceberg"."default"."events_streaming__dbt_tmp"
[0m13:17:16.234650 [debug] [Thread-1  ]: Using trino connection "model.iceberg_project.events_streaming"
[0m13:17:16.234955 [debug] [Thread-1  ]: On model.iceberg_project.events_streaming: drop view if exists "iceberg"."default"."events_streaming__dbt_tmp"
/* dbt: dev */
[0m13:17:16.275042 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.040 seconds
[0m13:17:16.284922 [debug] [Thread-1  ]: On model.iceberg_project.events_streaming: ROLLBACK
[0m13:17:16.285316 [debug] [Thread-1  ]: On model.iceberg_project.events_streaming: Close
[0m13:17:16.286738 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5c029794-bfcc-4904-8ea0-f2b2b18fc6fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb8e1c0>]}
[0m13:17:16.287255 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental model default.events_streaming ............... [[32mCREATE TABLE (5 rows)[0m in 2.31s]
[0m13:17:16.287655 [debug] [Thread-1  ]: Finished running node model.iceberg_project.events_streaming
[0m13:17:16.288406 [debug] [MainThread]: On master: COMMIT
[0m13:17:16.288717 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:17:16.288910 [debug] [MainThread]: Connection 'model.iceberg_project.events_streaming' was properly closed.
[0m13:17:16.289120 [info ] [MainThread]: 
[0m13:17:16.289377 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 2.76 seconds (2.76s).
[0m13:17:16.289894 [debug] [MainThread]: Command end result
[0m13:17:16.306132 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/target/manifest.json
[0m13:17:16.307330 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/target/semantic_manifest.json
[0m13:17:16.311538 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/target/run_results.json
[0m13:17:16.311875 [info ] [MainThread]: 
[0m13:17:16.312217 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:17:16.312449 [info ] [MainThread]: 
[0m13:17:16.312673 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:17:16.314176 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.6617768, "process_in_blocks": "0", "process_kernel_time": 0.199989, "process_mem_max_rss": "124256256", "process_out_blocks": "0", "process_user_time": 1.668681}
[0m13:17:16.314572 [debug] [MainThread]: Command `dbt run` succeeded at 13:17:16.314510 after 3.66 seconds
[0m13:17:16.314847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f66580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b21eb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aac0fa0>]}
[0m13:17:16.315106 [debug] [MainThread]: Flushing usage events
[0m13:17:16.444194 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:17:29.361723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10791d640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087cf6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1087cf130>]}


============================== 13:17:29.364573 | 55ddba13-6217-40cf-9e5d-42caad9aa91f ==============================
[0m13:17:29.364573 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:17:29.364992 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'False', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/logs', 'profiles_dir': '/Users/ankurchopra/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --models kafka_to_iceberg.events_streaming', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:17:29.560492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '55ddba13-6217-40cf-9e5d-42caad9aa91f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069512e0>]}
[0m13:17:29.606546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '55ddba13-6217-40cf-9e5d-42caad9aa91f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108607b80>]}
[0m13:17:29.607053 [info ] [MainThread]: Registered adapter: trino=1.8.5
[0m13:17:29.676257 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:17:29.776712 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:17:29.777183 [debug] [MainThread]: Partial parsing: updated file: iceberg_project://models/kafka_to_iceberg/events_streaming.sql
[0m13:17:30.120379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '55ddba13-6217-40cf-9e5d-42caad9aa91f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f7a670>]}
[0m13:17:30.189218 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/target/manifest.json
[0m13:17:30.190534 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/target/semantic_manifest.json
[0m13:17:30.196645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '55ddba13-6217-40cf-9e5d-42caad9aa91f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f34d30>]}
[0m13:17:30.196951 [info ] [MainThread]: Found 5 models, 3 data tests, 1 source, 458 macros
[0m13:17:30.197167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55ddba13-6217-40cf-9e5d-42caad9aa91f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f407c0>]}
[0m13:17:30.197828 [info ] [MainThread]: 
[0m13:17:30.198034 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:17:30.198210 [info ] [MainThread]: 
[0m13:17:30.198474 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m13:17:30.198913 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
[0m13:17:30.228848 [debug] [ThreadPool]: Using trino connection "list_iceberg"
[0m13:17:30.229133 [debug] [ThreadPool]: On list_iceberg: select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
/* dbt: dev */
[0m13:17:30.229310 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:17:30.229468 [warn ] [ThreadPool]: [[33mWARNING[0m]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.
You may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.
Visit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.
[0m13:17:30.229732 [debug] [ThreadPool]: Sending event: {'category': 'dbt', 'action': 'BehaviorChangeEvent', 'label': '55ddba13-6217-40cf-9e5d-42caad9aa91f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10926f520>]}
[0m13:17:30.394455 [debug] [ThreadPool]: SQL status: SUCCESS in 0.165 seconds
[0m13:17:30.395370 [debug] [ThreadPool]: On list_iceberg: Close
[0m13:17:30.399116 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_default)
[0m13:17:30.409621 [debug] [ThreadPool]: Using trino connection "list_iceberg_default"
[0m13:17:30.410015 [debug] [ThreadPool]: On list_iceberg_default: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'default') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'default'
/* dbt: dev */
[0m13:17:30.410244 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:17:30.592340 [debug] [ThreadPool]: SQL status: SUCCESS in 0.182 seconds
[0m13:17:30.594639 [debug] [ThreadPool]: On list_iceberg_default: ROLLBACK
[0m13:17:30.595005 [debug] [ThreadPool]: On list_iceberg_default: Close
[0m13:17:30.596079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '55ddba13-6217-40cf-9e5d-42caad9aa91f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109049fa0>]}
[0m13:17:30.596440 [debug] [MainThread]: On master: COMMIT
[0m13:17:30.597959 [debug] [Thread-1  ]: Began running node model.iceberg_project.events_streaming
[0m13:17:30.598360 [info ] [Thread-1  ]: 1 of 1 START sql incremental model default.events_streaming .................... [RUN]
[0m13:17:30.598650 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_iceberg_default, now model.iceberg_project.events_streaming)
[0m13:17:30.598884 [debug] [Thread-1  ]: Began compiling node model.iceberg_project.events_streaming
[0m13:17:30.604513 [debug] [Thread-1  ]: Using trino connection "model.iceberg_project.events_streaming"
[0m13:17:30.604839 [debug] [Thread-1  ]: On model.iceberg_project.events_streaming: SELECT COALESCE(MAX(_kafka_offset), -1) as max_offset
        FROM "iceberg"."default"."events_streaming"
/* dbt: dev */
[0m13:17:30.605069 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:17:30.761744 [debug] [Thread-1  ]: Trino adapter: Trino query id: 20250318_050116_00050_j25rb
[0m13:17:30.762939 [debug] [Thread-1  ]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 1:21: Column '_kafka_offset' cannot be resolved", query_id=20250318_050116_00050_j25rb)
[0m13:17:30.765051 [debug] [Thread-1  ]: On model.iceberg_project.events_streaming: Close
[0m13:17:30.770309 [debug] [Thread-1  ]: Database Error in model events_streaming (models/kafka_to_iceberg/events_streaming.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 1:21: Column '_kafka_offset' cannot be resolved", query_id=20250318_050116_00050_j25rb)
[0m13:17:30.771613 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '55ddba13-6217-40cf-9e5d-42caad9aa91f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10971f910>]}
[0m13:17:30.772093 [error] [Thread-1  ]: 1 of 1 ERROR creating sql incremental model default.events_streaming ........... [[31mERROR[0m in 0.17s]
[0m13:17:30.772452 [debug] [Thread-1  ]: Finished running node model.iceberg_project.events_streaming
[0m13:17:30.772850 [debug] [Thread-4  ]: Marking all children of 'model.iceberg_project.events_streaming' to be skipped because of status 'error'.  Reason: Database Error in model events_streaming (models/kafka_to_iceberg/events_streaming.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 1:21: Column '_kafka_offset' cannot be resolved", query_id=20250318_050116_00050_j25rb).
[0m13:17:30.773642 [debug] [MainThread]: On master: COMMIT
[0m13:17:30.773879 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:17:30.774050 [debug] [MainThread]: Connection 'model.iceberg_project.events_streaming' was properly closed.
[0m13:17:30.774239 [info ] [MainThread]: 
[0m13:17:30.774436 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.58 seconds (0.58s).
[0m13:17:30.774798 [debug] [MainThread]: Command end result
[0m13:17:30.791439 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/target/manifest.json
[0m13:17:30.792767 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/target/semantic_manifest.json
[0m13:17:30.797232 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/target/run_results.json
[0m13:17:30.797508 [info ] [MainThread]: 
[0m13:17:30.797775 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:17:30.797981 [info ] [MainThread]: 
[0m13:17:30.798221 [error] [MainThread]:   Database Error in model events_streaming (models/kafka_to_iceberg/events_streaming.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 1:21: Column '_kafka_offset' cannot be resolved", query_id=20250318_050116_00050_j25rb)
[0m13:17:30.798412 [info ] [MainThread]: 
[0m13:17:30.798611 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:17:30.805649 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.4961994, "process_in_blocks": "0", "process_kernel_time": 0.18081, "process_mem_max_rss": "125026304", "process_out_blocks": "0", "process_user_time": 1.573561}
[0m13:17:30.806134 [debug] [MainThread]: Command `dbt run` failed at 13:17:30.806073 after 1.50 seconds
[0m13:17:30.806420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10791d640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108f34220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106a85a60>]}
[0m13:17:30.806691 [debug] [MainThread]: Flushing usage events
[0m13:17:30.921647 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:17:49.876805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ca6580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b575b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b57190>]}


============================== 13:17:49.879756 | dd6661c7-4fab-4a92-ab0a-c4e327751aa0 ==============================
[0m13:17:49.879756 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:17:49.880144 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ankurchopra/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/logs', 'fail_fast': 'False', 'warn_error': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run --models kafka_to_iceberg.events_streaming', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:17:50.029040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dd6661c7-4fab-4a92-ab0a-c4e327751aa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102cd82e0>]}
[0m13:17:50.073790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dd6661c7-4fab-4a92-ab0a-c4e327751aa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e6bc40>]}
[0m13:17:50.074308 [info ] [MainThread]: Registered adapter: trino=1.8.5
[0m13:17:50.143362 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:17:50.243771 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:17:50.244248 [debug] [MainThread]: Partial parsing: updated file: iceberg_project://models/kafka_to_iceberg/events_streaming.sql
[0m13:17:50.588547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dd6661c7-4fab-4a92-ab0a-c4e327751aa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105300eb0>]}
[0m13:17:50.657661 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/target/manifest.json
[0m13:17:50.658937 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/target/semantic_manifest.json
[0m13:17:50.664738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dd6661c7-4fab-4a92-ab0a-c4e327751aa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10558f460>]}
[0m13:17:50.665062 [info ] [MainThread]: Found 5 models, 3 data tests, 1 source, 458 macros
[0m13:17:50.665286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd6661c7-4fab-4a92-ab0a-c4e327751aa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ea38e0>]}
[0m13:17:50.665992 [info ] [MainThread]: 
[0m13:17:50.666210 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:17:50.666394 [info ] [MainThread]: 
[0m13:17:50.666663 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m13:17:50.667129 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
[0m13:17:50.698617 [debug] [ThreadPool]: Using trino connection "list_iceberg"
[0m13:17:50.698919 [debug] [ThreadPool]: On list_iceberg: select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
/* dbt: dev */
[0m13:17:50.699099 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:17:50.699260 [warn ] [ThreadPool]: [[33mWARNING[0m]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.
You may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.
Visit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.
[0m13:17:50.699529 [debug] [ThreadPool]: Sending event: {'category': 'dbt', 'action': 'BehaviorChangeEvent', 'label': 'dd6661c7-4fab-4a92-ab0a-c4e327751aa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055f9b20>]}
[0m13:17:50.779809 [debug] [ThreadPool]: SQL status: SUCCESS in 0.081 seconds
[0m13:17:50.780776 [debug] [ThreadPool]: On list_iceberg: Close
[0m13:17:50.784335 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_default)
[0m13:17:50.793976 [debug] [ThreadPool]: Using trino connection "list_iceberg_default"
[0m13:17:50.794281 [debug] [ThreadPool]: On list_iceberg_default: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'default') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'default'
/* dbt: dev */
[0m13:17:50.794492 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:17:50.965206 [debug] [ThreadPool]: SQL status: SUCCESS in 0.171 seconds
[0m13:17:50.966130 [debug] [ThreadPool]: On list_iceberg_default: ROLLBACK
[0m13:17:50.966330 [debug] [ThreadPool]: On list_iceberg_default: Close
[0m13:17:50.967397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd6661c7-4fab-4a92-ab0a-c4e327751aa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102bf8e50>]}
[0m13:17:50.967777 [debug] [MainThread]: On master: COMMIT
[0m13:17:50.969390 [debug] [Thread-1  ]: Began running node model.iceberg_project.events_streaming
[0m13:17:50.969858 [info ] [Thread-1  ]: 1 of 1 START sql incremental model default.events_streaming .................... [RUN]
[0m13:17:50.970216 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_iceberg_default, now model.iceberg_project.events_streaming)
[0m13:17:50.970472 [debug] [Thread-1  ]: Began compiling node model.iceberg_project.events_streaming
[0m13:17:50.976246 [debug] [Thread-1  ]: Using trino connection "model.iceberg_project.events_streaming"
[0m13:17:50.976579 [debug] [Thread-1  ]: On model.iceberg_project.events_streaming: SELECT COALESCE(MAX(_kafka_offset), -1) as max_offset
        FROM "iceberg"."default"."events_streaming"
/* dbt: dev */
[0m13:17:50.976810 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:17:51.025027 [debug] [Thread-1  ]: Trino adapter: Trino query id: 20250318_050136_00053_j25rb
[0m13:17:51.025415 [debug] [Thread-1  ]: Trino adapter: Trino error: TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 1:21: Column '_kafka_offset' cannot be resolved", query_id=20250318_050136_00053_j25rb)
[0m13:17:51.026720 [debug] [Thread-1  ]: On model.iceberg_project.events_streaming: Close
[0m13:17:51.031607 [debug] [Thread-1  ]: Database Error in model events_streaming (models/kafka_to_iceberg/events_streaming.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 1:21: Column '_kafka_offset' cannot be resolved", query_id=20250318_050136_00053_j25rb)
[0m13:17:51.033020 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dd6661c7-4fab-4a92-ab0a-c4e327751aa0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105aa8790>]}
[0m13:17:51.033540 [error] [Thread-1  ]: 1 of 1 ERROR creating sql incremental model default.events_streaming ........... [[31mERROR[0m in 0.06s]
[0m13:17:51.033940 [debug] [Thread-1  ]: Finished running node model.iceberg_project.events_streaming
[0m13:17:51.034303 [debug] [Thread-4  ]: Marking all children of 'model.iceberg_project.events_streaming' to be skipped because of status 'error'.  Reason: Database Error in model events_streaming (models/kafka_to_iceberg/events_streaming.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 1:21: Column '_kafka_offset' cannot be resolved", query_id=20250318_050136_00053_j25rb).
[0m13:17:51.035025 [debug] [MainThread]: On master: COMMIT
[0m13:17:51.035301 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:17:51.035489 [debug] [MainThread]: Connection 'model.iceberg_project.events_streaming' was properly closed.
[0m13:17:51.035684 [info ] [MainThread]: 
[0m13:17:51.035898 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 0.37 seconds (0.37s).
[0m13:17:51.036267 [debug] [MainThread]: Command end result
[0m13:17:51.052825 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/target/manifest.json
[0m13:17:51.054489 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/target/semantic_manifest.json
[0m13:17:51.058483 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/target/run_results.json
[0m13:17:51.058801 [info ] [MainThread]: 
[0m13:17:51.059211 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:17:51.059441 [info ] [MainThread]: 
[0m13:17:51.059709 [error] [MainThread]:   Database Error in model events_streaming (models/kafka_to_iceberg/events_streaming.sql)
  TrinoUserError(type=USER_ERROR, name=COLUMN_NOT_FOUND, message="line 1:21: Column '_kafka_offset' cannot be resolved", query_id=20250318_050136_00053_j25rb)
[0m13:17:51.059912 [info ] [MainThread]: 
[0m13:17:51.060116 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:17:51.061578 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.2356901, "process_in_blocks": "0", "process_kernel_time": 0.175313, "process_mem_max_rss": "127385600", "process_out_blocks": "0", "process_user_time": 1.562469}
[0m13:17:51.061895 [debug] [MainThread]: Command `dbt run` failed at 13:17:51.061846 after 1.24 seconds
[0m13:17:51.062144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ca6580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e2f250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10558f580>]}
[0m13:17:51.062377 [debug] [MainThread]: Flushing usage events
[0m13:17:51.175398 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:18:08.986817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cee520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109da34f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109da3f70>]}


============================== 13:18:08.989722 | 50f48794-a7b9-4931-94ae-b30203b32cfa ==============================
[0m13:18:08.989722 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:18:08.990113 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/ankurchopra/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/logs', 'warn_error': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --models kafka_to_iceberg.events_streaming', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:18:09.165991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '50f48794-a7b9-4931-94ae-b30203b32cfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b0d340>]}
[0m13:18:09.211209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '50f48794-a7b9-4931-94ae-b30203b32cfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109f337c0>]}
[0m13:18:09.211726 [info ] [MainThread]: Registered adapter: trino=1.8.5
[0m13:18:09.278098 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:18:09.377293 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:18:09.377790 [debug] [MainThread]: Partial parsing: updated file: iceberg_project://models/kafka_to_iceberg/events_streaming.sql
[0m13:18:09.720015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '50f48794-a7b9-4931-94ae-b30203b32cfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x109bdc130>]}
[0m13:18:09.786709 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/target/manifest.json
[0m13:18:09.787952 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/target/semantic_manifest.json
[0m13:18:09.794036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '50f48794-a7b9-4931-94ae-b30203b32cfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5d0400>]}
[0m13:18:09.794355 [info ] [MainThread]: Found 5 models, 3 data tests, 1 source, 458 macros
[0m13:18:09.794581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50f48794-a7b9-4931-94ae-b30203b32cfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a9a9d60>]}
[0m13:18:09.795261 [info ] [MainThread]: 
[0m13:18:09.795469 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:18:09.795653 [info ] [MainThread]: 
[0m13:18:09.795928 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m13:18:09.796395 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
[0m13:18:09.825614 [debug] [ThreadPool]: Using trino connection "list_iceberg"
[0m13:18:09.825909 [debug] [ThreadPool]: On list_iceberg: select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
/* dbt: dev */
[0m13:18:09.826097 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:18:09.826264 [warn ] [ThreadPool]: [[33mWARNING[0m]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.
You may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.
Visit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.
[0m13:18:09.826536 [debug] [ThreadPool]: Sending event: {'category': 'dbt', 'action': 'BehaviorChangeEvent', 'label': '50f48794-a7b9-4931-94ae-b30203b32cfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a730340>]}
[0m13:18:09.878831 [debug] [ThreadPool]: SQL status: SUCCESS in 0.053 seconds
[0m13:18:09.879873 [debug] [ThreadPool]: On list_iceberg: Close
[0m13:18:09.883482 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_default)
[0m13:18:09.893569 [debug] [ThreadPool]: Using trino connection "list_iceberg_default"
[0m13:18:09.893913 [debug] [ThreadPool]: On list_iceberg_default: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'default') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'default'
/* dbt: dev */
[0m13:18:09.894113 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:18:10.035760 [debug] [ThreadPool]: SQL status: SUCCESS in 0.142 seconds
[0m13:18:10.036695 [debug] [ThreadPool]: On list_iceberg_default: ROLLBACK
[0m13:18:10.036899 [debug] [ThreadPool]: On list_iceberg_default: Close
[0m13:18:10.037721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50f48794-a7b9-4931-94ae-b30203b32cfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b92730>]}
[0m13:18:10.038055 [debug] [MainThread]: On master: COMMIT
[0m13:18:10.039696 [debug] [Thread-1  ]: Began running node model.iceberg_project.events_streaming
[0m13:18:10.040154 [info ] [Thread-1  ]: 1 of 1 START sql incremental model default.events_streaming .................... [RUN]
[0m13:18:10.040454 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_iceberg_default, now model.iceberg_project.events_streaming)
[0m13:18:10.040685 [debug] [Thread-1  ]: Began compiling node model.iceberg_project.events_streaming
[0m13:18:10.046111 [debug] [Thread-1  ]: Using trino connection "model.iceberg_project.events_streaming"
[0m13:18:10.046433 [debug] [Thread-1  ]: On model.iceberg_project.events_streaming: SELECT COALESCE(MAX(_partition_offset), -1) as max_offset
        FROM "iceberg"."default"."events_streaming"
/* dbt: dev */
[0m13:18:10.046664 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:18:10.452591 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.406 seconds
[0m13:18:10.454549 [debug] [Thread-1  ]: Writing injected SQL for node "model.iceberg_project.events_streaming"
[0m13:18:10.455237 [debug] [Thread-1  ]: Began executing node model.iceberg_project.events_streaming
[0m13:18:10.485667 [debug] [Thread-1  ]: Using trino connection "model.iceberg_project.events_streaming"
[0m13:18:10.486066 [debug] [Thread-1  ]: On model.iceberg_project.events_streaming: create or replace view
    "iceberg"."default"."events_streaming__dbt_tmp"
  security definer
  as
    







    


WITH kafka_data AS (
    SELECT
        CAST(JSON_EXTRACT_SCALAR(CAST(_message AS VARCHAR), '$.id') AS BIGINT) AS id,
        JSON_EXTRACT_SCALAR(CAST(_message AS VARCHAR), '$.name') AS name,
        CAST(JSON_EXTRACT_SCALAR(CAST(_message AS VARCHAR), '$.created_at') AS TIMESTAMP(6)) AS created_at,
        _partition_id,
        _partition_offset
    FROM "kafka"."default"."events_topic"
    
    WHERE _partition_offset > 4
    
)

SELECT
    id,
    name,
    created_at,
    _partition_id,
    _partition_offset,
    CAST(CURRENT_TIMESTAMP AS TIMESTAMP(6)) AS processed_at
FROM kafka_data
WHERE id IS NOT NULL
  
/* dbt: dev */
[0m13:18:10.592949 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.107 seconds
[0m13:18:10.598501 [debug] [Thread-1  ]: Using trino connection "model.iceberg_project.events_streaming"
[0m13:18:10.598819 [debug] [Thread-1  ]: On model.iceberg_project.events_streaming: describe "iceberg"."default"."events_streaming__dbt_tmp"
/* dbt: dev */
[0m13:18:10.733084 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.134 seconds
[0m13:18:10.738238 [debug] [Thread-1  ]: Using trino connection "model.iceberg_project.events_streaming"
[0m13:18:10.738602 [debug] [Thread-1  ]: On model.iceberg_project.events_streaming: describe "iceberg"."default"."events_streaming"
/* dbt: dev */
[0m13:18:10.937771 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.199 seconds
[0m13:18:10.944005 [debug] [Thread-1  ]: Using trino connection "model.iceberg_project.events_streaming"
[0m13:18:10.944471 [debug] [Thread-1  ]: On model.iceberg_project.events_streaming: describe "iceberg"."default"."events_streaming"
/* dbt: dev */
[0m13:18:11.044183 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.099 seconds
[0m13:18:11.059427 [debug] [Thread-1  ]: Writing runtime sql for node "model.iceberg_project.events_streaming"
[0m13:18:11.061780 [debug] [Thread-1  ]: Using trino connection "model.iceberg_project.events_streaming"
[0m13:18:11.062141 [debug] [Thread-1  ]: On model.iceberg_project.events_streaming: -- back compat for old kwarg name
  
  
        
            
            
        

        

        merge into "iceberg"."default"."events_streaming" as DBT_INTERNAL_DEST
            using "iceberg"."default"."events_streaming__dbt_tmp" as DBT_INTERNAL_SOURCE
            on (
                DBT_INTERNAL_SOURCE.id = DBT_INTERNAL_DEST.id
            )

        
        when matched then update set
            "id" = DBT_INTERNAL_SOURCE."id","name" = DBT_INTERNAL_SOURCE."name","created_at" = DBT_INTERNAL_SOURCE."created_at","_partition_id" = DBT_INTERNAL_SOURCE."_partition_id","_partition_offset" = DBT_INTERNAL_SOURCE."_partition_offset","processed_at" = DBT_INTERNAL_SOURCE."processed_at"
        

        when not matched then insert
            ("id", "name", "created_at", "_partition_id", "_partition_offset", "processed_at")
        values
            (DBT_INTERNAL_SOURCE."id", DBT_INTERNAL_SOURCE."name", DBT_INTERNAL_SOURCE."created_at", DBT_INTERNAL_SOURCE."_partition_id", DBT_INTERNAL_SOURCE."_partition_offset", DBT_INTERNAL_SOURCE."processed_at")
/* dbt: dev */
[0m13:18:12.272860 [debug] [Thread-1  ]: SQL status: MERGE (0 rows) in 1.209 seconds
[0m13:18:12.285332 [debug] [Thread-1  ]: Applying DROP to: "iceberg"."default"."events_streaming__dbt_tmp"
[0m13:18:12.287210 [debug] [Thread-1  ]: Using trino connection "model.iceberg_project.events_streaming"
[0m13:18:12.287515 [debug] [Thread-1  ]: On model.iceberg_project.events_streaming: drop view if exists "iceberg"."default"."events_streaming__dbt_tmp"
/* dbt: dev */
[0m13:18:13.207997 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.920 seconds
[0m13:18:13.221622 [debug] [Thread-1  ]: On model.iceberg_project.events_streaming: ROLLBACK
[0m13:18:13.222000 [debug] [Thread-1  ]: On model.iceberg_project.events_streaming: Close
[0m13:18:13.224061 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '50f48794-a7b9-4931-94ae-b30203b32cfa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af882b0>]}
[0m13:18:13.224930 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental model default.events_streaming ............... [[32mMERGE (0 rows)[0m in 3.18s]
[0m13:18:13.225565 [debug] [Thread-1  ]: Finished running node model.iceberg_project.events_streaming
[0m13:18:13.227078 [debug] [MainThread]: On master: COMMIT
[0m13:18:13.227513 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:18:13.227748 [debug] [MainThread]: Connection 'model.iceberg_project.events_streaming' was properly closed.
[0m13:18:13.227972 [info ] [MainThread]: 
[0m13:18:13.228208 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 3.43 seconds (3.43s).
[0m13:18:13.228664 [debug] [MainThread]: Command end result
[0m13:18:13.248841 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/target/manifest.json
[0m13:18:13.254304 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/target/semantic_manifest.json
[0m13:18:13.259406 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/target/run_results.json
[0m13:18:13.259768 [info ] [MainThread]: 
[0m13:18:13.260081 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:18:13.260290 [info ] [MainThread]: 
[0m13:18:13.260530 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:18:13.262328 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 4.3290524, "process_in_blocks": "0", "process_kernel_time": 0.213719, "process_mem_max_rss": "126943232", "process_out_blocks": "0", "process_user_time": 1.723118}
[0m13:18:13.262862 [debug] [MainThread]: Command `dbt run` succeeded at 13:18:13.262795 after 4.33 seconds
[0m13:18:13.263216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cee520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a96dd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b0d340>]}
[0m13:18:13.263481 [debug] [MainThread]: Flushing usage events
[0m13:18:13.382044 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:21:18.386171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10602d610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077e3640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077e3160>]}


============================== 13:21:18.389132 | eb156b62-51d6-4f02-9a8f-5875bd841103 ==============================
[0m13:21:18.389132 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:21:18.389508 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'False', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/logs', 'profiles_dir': '/Users/ankurchopra/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --models kafka_to_iceberg.events_streaming', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:21:18.580805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eb156b62-51d6-4f02-9a8f-5875bd841103', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10454d2e0>]}
[0m13:21:18.624844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eb156b62-51d6-4f02-9a8f-5875bd841103', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1073be6d0>]}
[0m13:21:18.625377 [info ] [MainThread]: Registered adapter: trino=1.8.5
[0m13:21:18.699258 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:21:18.806826 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:21:18.807147 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:21:18.842321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eb156b62-51d6-4f02-9a8f-5875bd841103', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101c1d30>]}
[0m13:21:18.913809 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/target/manifest.json
[0m13:21:18.915060 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/target/semantic_manifest.json
[0m13:21:18.921895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eb156b62-51d6-4f02-9a8f-5875bd841103', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101f4f70>]}
[0m13:21:18.922239 [info ] [MainThread]: Found 5 models, 3 data tests, 1 source, 458 macros
[0m13:21:18.922454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb156b62-51d6-4f02-9a8f-5875bd841103', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110195340>]}
[0m13:21:18.923184 [info ] [MainThread]: 
[0m13:21:18.923416 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:21:18.923593 [info ] [MainThread]: 
[0m13:21:18.923872 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m13:21:18.924349 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
[0m13:21:18.959561 [debug] [ThreadPool]: Using trino connection "list_iceberg"
[0m13:21:18.959851 [debug] [ThreadPool]: On list_iceberg: select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
/* dbt: dev */
[0m13:21:18.960030 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:21:18.960196 [warn ] [ThreadPool]: [[33mWARNING[0m]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.
You may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.
Visit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.
[0m13:21:18.960472 [debug] [ThreadPool]: Sending event: {'category': 'dbt', 'action': 'BehaviorChangeEvent', 'label': 'eb156b62-51d6-4f02-9a8f-5875bd841103', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11037ae80>]}
[0m13:21:19.159880 [debug] [ThreadPool]: SQL status: SUCCESS in 0.200 seconds
[0m13:21:19.160830 [debug] [ThreadPool]: On list_iceberg: Close
[0m13:21:19.164261 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_default)
[0m13:21:19.204466 [debug] [ThreadPool]: Using trino connection "list_iceberg_default"
[0m13:21:19.204844 [debug] [ThreadPool]: On list_iceberg_default: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'default') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'default'
/* dbt: dev */
[0m13:21:19.205062 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:21:19.530223 [debug] [ThreadPool]: SQL status: SUCCESS in 0.325 seconds
[0m13:21:19.532684 [debug] [ThreadPool]: On list_iceberg_default: ROLLBACK
[0m13:21:19.533266 [debug] [ThreadPool]: On list_iceberg_default: Close
[0m13:21:19.535001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb156b62-51d6-4f02-9a8f-5875bd841103', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107cb65b0>]}
[0m13:21:19.535533 [debug] [MainThread]: On master: COMMIT
[0m13:21:19.537421 [debug] [Thread-1  ]: Began running node model.iceberg_project.events_streaming
[0m13:21:19.537872 [info ] [Thread-1  ]: 1 of 1 START sql incremental model default.events_streaming .................... [RUN]
[0m13:21:19.538210 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_iceberg_default, now model.iceberg_project.events_streaming)
[0m13:21:19.538464 [debug] [Thread-1  ]: Began compiling node model.iceberg_project.events_streaming
[0m13:21:19.546977 [debug] [Thread-1  ]: Using trino connection "model.iceberg_project.events_streaming"
[0m13:21:19.547315 [debug] [Thread-1  ]: On model.iceberg_project.events_streaming: SELECT COALESCE(MAX(_partition_offset), -1) as max_offset
        FROM "iceberg"."default"."events_streaming"
/* dbt: dev */
[0m13:21:19.547540 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:21:19.675880 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.128 seconds
[0m13:21:19.678853 [debug] [Thread-1  ]: Writing injected SQL for node "model.iceberg_project.events_streaming"
[0m13:21:19.680070 [debug] [Thread-1  ]: Began executing node model.iceberg_project.events_streaming
[0m13:21:19.711962 [debug] [Thread-1  ]: Using trino connection "model.iceberg_project.events_streaming"
[0m13:21:19.712401 [debug] [Thread-1  ]: On model.iceberg_project.events_streaming: create or replace view
    "iceberg"."default"."events_streaming__dbt_tmp"
  security definer
  as
    







    


WITH kafka_data AS (
    SELECT
        CAST(JSON_EXTRACT_SCALAR(CAST(_message AS VARCHAR), '$.id') AS BIGINT) AS id,
        JSON_EXTRACT_SCALAR(CAST(_message AS VARCHAR), '$.name') AS name,
        CAST(JSON_EXTRACT_SCALAR(CAST(_message AS VARCHAR), '$.created_at') AS TIMESTAMP(6)) AS created_at,
        _partition_id,
        _partition_offset
    FROM "kafka"."default"."events_topic"
    
    WHERE _partition_offset > 4
    
)

SELECT
    id,
    name,
    created_at,
    _partition_id,
    _partition_offset,
    CAST(CURRENT_TIMESTAMP AS TIMESTAMP(6)) AS processed_at
FROM kafka_data
WHERE id IS NOT NULL
  
/* dbt: dev */
[0m13:21:19.767683 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.055 seconds
[0m13:21:19.774007 [debug] [Thread-1  ]: Using trino connection "model.iceberg_project.events_streaming"
[0m13:21:19.774330 [debug] [Thread-1  ]: On model.iceberg_project.events_streaming: describe "iceberg"."default"."events_streaming__dbt_tmp"
/* dbt: dev */
[0m13:21:19.873534 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.099 seconds
[0m13:21:19.876245 [debug] [Thread-1  ]: Using trino connection "model.iceberg_project.events_streaming"
[0m13:21:19.876582 [debug] [Thread-1  ]: On model.iceberg_project.events_streaming: describe "iceberg"."default"."events_streaming"
/* dbt: dev */
[0m13:21:19.959742 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.083 seconds
[0m13:21:19.966482 [debug] [Thread-1  ]: Using trino connection "model.iceberg_project.events_streaming"
[0m13:21:19.966861 [debug] [Thread-1  ]: On model.iceberg_project.events_streaming: describe "iceberg"."default"."events_streaming"
/* dbt: dev */
[0m13:21:20.054680 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.088 seconds
[0m13:21:20.069595 [debug] [Thread-1  ]: Writing runtime sql for node "model.iceberg_project.events_streaming"
[0m13:21:20.072189 [debug] [Thread-1  ]: Using trino connection "model.iceberg_project.events_streaming"
[0m13:21:20.072573 [debug] [Thread-1  ]: On model.iceberg_project.events_streaming: -- back compat for old kwarg name
  
  
        
            
            
        

        

        merge into "iceberg"."default"."events_streaming" as DBT_INTERNAL_DEST
            using "iceberg"."default"."events_streaming__dbt_tmp" as DBT_INTERNAL_SOURCE
            on (
                DBT_INTERNAL_SOURCE.id = DBT_INTERNAL_DEST.id
            )

        
        when matched then update set
            "id" = DBT_INTERNAL_SOURCE."id","name" = DBT_INTERNAL_SOURCE."name","created_at" = DBT_INTERNAL_SOURCE."created_at","_partition_id" = DBT_INTERNAL_SOURCE."_partition_id","_partition_offset" = DBT_INTERNAL_SOURCE."_partition_offset","processed_at" = DBT_INTERNAL_SOURCE."processed_at"
        

        when not matched then insert
            ("id", "name", "created_at", "_partition_id", "_partition_offset", "processed_at")
        values
            (DBT_INTERNAL_SOURCE."id", DBT_INTERNAL_SOURCE."name", DBT_INTERNAL_SOURCE."created_at", DBT_INTERNAL_SOURCE."_partition_id", DBT_INTERNAL_SOURCE."_partition_offset", DBT_INTERNAL_SOURCE."processed_at")
/* dbt: dev */
[0m13:21:21.049338 [debug] [Thread-1  ]: SQL status: MERGE (5 rows) in 0.976 seconds
[0m13:21:21.054206 [debug] [Thread-1  ]: Applying DROP to: "iceberg"."default"."events_streaming__dbt_tmp"
[0m13:21:21.055541 [debug] [Thread-1  ]: Using trino connection "model.iceberg_project.events_streaming"
[0m13:21:21.055808 [debug] [Thread-1  ]: On model.iceberg_project.events_streaming: drop view if exists "iceberg"."default"."events_streaming__dbt_tmp"
/* dbt: dev */
[0m13:21:21.145105 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.089 seconds
[0m13:21:21.157844 [debug] [Thread-1  ]: On model.iceberg_project.events_streaming: ROLLBACK
[0m13:21:21.158197 [debug] [Thread-1  ]: On model.iceberg_project.events_streaming: Close
[0m13:21:21.159659 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb156b62-51d6-4f02-9a8f-5875bd841103', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107bac8b0>]}
[0m13:21:21.160183 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental model default.events_streaming ............... [[32mMERGE (5 rows)[0m in 1.62s]
[0m13:21:21.160558 [debug] [Thread-1  ]: Finished running node model.iceberg_project.events_streaming
[0m13:21:21.161362 [debug] [MainThread]: On master: COMMIT
[0m13:21:21.161652 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:21:21.161836 [debug] [MainThread]: Connection 'model.iceberg_project.events_streaming' was properly closed.
[0m13:21:21.162035 [info ] [MainThread]: 
[0m13:21:21.162242 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 2.24 seconds (2.24s).
[0m13:21:21.162634 [debug] [MainThread]: Command end result
[0m13:21:21.178880 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/target/manifest.json
[0m13:21:21.179950 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/target/semantic_manifest.json
[0m13:21:21.185302 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/target/run_results.json
[0m13:21:21.185581 [info ] [MainThread]: 
[0m13:21:21.194991 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:21:21.196057 [info ] [MainThread]: 
[0m13:21:21.196320 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:21:21.198360 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.8673718, "process_in_blocks": "0", "process_kernel_time": 0.194471, "process_mem_max_rss": "120242176", "process_out_blocks": "0", "process_user_time": 1.465011}
[0m13:21:21.198699 [debug] [MainThread]: Command `dbt run` succeeded at 13:21:21.198647 after 2.87 seconds
[0m13:21:21.198948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10602d610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10454d2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101f4940>]}
[0m13:21:21.199194 [debug] [MainThread]: Flushing usage events
[0m13:21:21.341343 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:21:55.065995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103775640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046276a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104627130>]}


============================== 13:21:55.069131 | 9a7d3066-c132-4923-923a-d871d1424563 ==============================
[0m13:21:55.069131 [info ] [MainThread]: Running with dbt=1.9.3
[0m13:21:55.069545 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'False', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/logs', 'debug': 'False', 'profiles_dir': '/Users/ankurchopra/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --models kafka_to_iceberg.events_streaming', 'send_anonymous_usage_stats': 'True'}
[0m13:21:55.247239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9a7d3066-c132-4923-923a-d871d1424563', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1027a82e0>]}
[0m13:21:55.290876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9a7d3066-c132-4923-923a-d871d1424563', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045d0880>]}
[0m13:21:55.291336 [info ] [MainThread]: Registered adapter: trino=1.8.5
[0m13:21:55.359501 [debug] [MainThread]: checksum: 5671c00892cdbcef29c3b00cc5ba7510c3d18a35c883caeb9ab9ee266dc29c8f, vars: {}, profile: , target: , version: 1.9.3
[0m13:21:55.457759 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:21:55.458083 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:21:55.493107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9a7d3066-c132-4923-923a-d871d1424563', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120002d60>]}
[0m13:21:55.563760 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/target/manifest.json
[0m13:21:55.565128 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/target/semantic_manifest.json
[0m13:21:55.571193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9a7d3066-c132-4923-923a-d871d1424563', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057ed100>]}
[0m13:21:55.571526 [info ] [MainThread]: Found 5 models, 3 data tests, 1 source, 458 macros
[0m13:21:55.571741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a7d3066-c132-4923-923a-d871d1424563', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057c1f40>]}
[0m13:21:55.572460 [info ] [MainThread]: 
[0m13:21:55.572677 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:21:55.572853 [info ] [MainThread]: 
[0m13:21:55.573175 [debug] [MainThread]: Acquiring new trino connection 'master'
[0m13:21:55.573695 [debug] [ThreadPool]: Acquiring new trino connection 'list_iceberg'
[0m13:21:55.608631 [debug] [ThreadPool]: Using trino connection "list_iceberg"
[0m13:21:55.608932 [debug] [ThreadPool]: On list_iceberg: select schema_name
    from "iceberg".INFORMATION_SCHEMA.schemata
/* dbt: dev */
[0m13:21:55.609131 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:21:55.609303 [warn ] [ThreadPool]: [[33mWARNING[0m]: SSL certificate validation is disabled by default. It is legacy behavior which will be changed in future releases. It is strongly advised to enable `require_certificate_validation` flag or explicitly set `cert` configuration to `True` for security reasons. You may receive an error after that if your SSL setup is incorrect.
You may opt into the new behavior sooner by setting `flags.require_certificate_validation` to `True` in `dbt_project.yml`.
Visit https://docs.getdbt.com/reference/global-configs/behavior-changes for more information.
[0m13:21:55.609576 [debug] [ThreadPool]: Sending event: {'category': 'dbt', 'action': 'BehaviorChangeEvent', 'label': '9a7d3066-c132-4923-923a-d871d1424563', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1203e4f70>]}
[0m13:21:55.769786 [debug] [ThreadPool]: SQL status: SUCCESS in 0.161 seconds
[0m13:21:55.770711 [debug] [ThreadPool]: On list_iceberg: Close
[0m13:21:55.774176 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_iceberg, now list_iceberg_default)
[0m13:21:55.811870 [debug] [ThreadPool]: Using trino connection "list_iceberg_default"
[0m13:21:55.812294 [debug] [ThreadPool]: On list_iceberg_default: select
      t.table_catalog as database,
      t.table_name as name,
      t.table_schema as schema,
      case when mv.name is not null then 'materialized_view'
           when t.table_type = 'BASE TABLE' then 'table'
           when t.table_type = 'VIEW' then 'view'
           else t.table_type
      end as table_type
    from "iceberg".INFORMATION_SCHEMA.tables t
    left join (
            select * from system.metadata.materialized_views
            where catalog_name = 'iceberg'
              and schema_name = 'default') mv
          on mv.catalog_name = t.table_catalog and mv.schema_name = t.table_schema and mv.name = t.table_name
    where t.table_schema = 'default'
/* dbt: dev */
[0m13:21:55.812547 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:21:55.967156 [debug] [ThreadPool]: SQL status: SUCCESS in 0.155 seconds
[0m13:21:55.968187 [debug] [ThreadPool]: On list_iceberg_default: ROLLBACK
[0m13:21:55.968433 [debug] [ThreadPool]: On list_iceberg_default: Close
[0m13:21:55.969350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9a7d3066-c132-4923-923a-d871d1424563', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b32610>]}
[0m13:21:55.969793 [debug] [MainThread]: On master: COMMIT
[0m13:21:55.971472 [debug] [Thread-1  ]: Began running node model.iceberg_project.events_streaming
[0m13:21:55.971804 [info ] [Thread-1  ]: 1 of 1 START sql incremental model default.events_streaming .................... [RUN]
[0m13:21:55.972057 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_iceberg_default, now model.iceberg_project.events_streaming)
[0m13:21:55.972274 [debug] [Thread-1  ]: Began compiling node model.iceberg_project.events_streaming
[0m13:21:55.980487 [debug] [Thread-1  ]: Using trino connection "model.iceberg_project.events_streaming"
[0m13:21:55.980809 [debug] [Thread-1  ]: On model.iceberg_project.events_streaming: SELECT COALESCE(MAX(_partition_offset), -1) as max_offset
        FROM "iceberg"."default"."events_streaming"
/* dbt: dev */
[0m13:21:55.981094 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m13:21:56.158296 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.177 seconds
[0m13:21:56.160173 [debug] [Thread-1  ]: Writing injected SQL for node "model.iceberg_project.events_streaming"
[0m13:21:56.160752 [debug] [Thread-1  ]: Began executing node model.iceberg_project.events_streaming
[0m13:21:56.191468 [debug] [Thread-1  ]: Using trino connection "model.iceberg_project.events_streaming"
[0m13:21:56.191862 [debug] [Thread-1  ]: On model.iceberg_project.events_streaming: create or replace view
    "iceberg"."default"."events_streaming__dbt_tmp"
  security definer
  as
    







    


WITH kafka_data AS (
    SELECT
        CAST(JSON_EXTRACT_SCALAR(CAST(_message AS VARCHAR), '$.id') AS BIGINT) AS id,
        JSON_EXTRACT_SCALAR(CAST(_message AS VARCHAR), '$.name') AS name,
        CAST(JSON_EXTRACT_SCALAR(CAST(_message AS VARCHAR), '$.created_at') AS TIMESTAMP(6)) AS created_at,
        _partition_id,
        _partition_offset
    FROM "kafka"."default"."events_topic"
    
    WHERE _partition_offset > 6
    
)

SELECT
    id,
    name,
    created_at,
    _partition_id,
    _partition_offset,
    CAST(CURRENT_TIMESTAMP AS TIMESTAMP(6)) AS processed_at
FROM kafka_data
WHERE id IS NOT NULL
  
/* dbt: dev */
[0m13:21:56.248173 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.056 seconds
[0m13:21:56.254148 [debug] [Thread-1  ]: Using trino connection "model.iceberg_project.events_streaming"
[0m13:21:56.254428 [debug] [Thread-1  ]: On model.iceberg_project.events_streaming: describe "iceberg"."default"."events_streaming__dbt_tmp"
/* dbt: dev */
[0m13:21:56.449443 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.195 seconds
[0m13:21:56.454468 [debug] [Thread-1  ]: Using trino connection "model.iceberg_project.events_streaming"
[0m13:21:56.454871 [debug] [Thread-1  ]: On model.iceberg_project.events_streaming: describe "iceberg"."default"."events_streaming"
/* dbt: dev */
[0m13:21:56.538421 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.083 seconds
[0m13:21:56.544839 [debug] [Thread-1  ]: Using trino connection "model.iceberg_project.events_streaming"
[0m13:21:56.545246 [debug] [Thread-1  ]: On model.iceberg_project.events_streaming: describe "iceberg"."default"."events_streaming"
/* dbt: dev */
[0m13:21:56.612065 [debug] [Thread-1  ]: SQL status: SUCCESS in 0.066 seconds
[0m13:21:56.627921 [debug] [Thread-1  ]: Writing runtime sql for node "model.iceberg_project.events_streaming"
[0m13:21:56.630425 [debug] [Thread-1  ]: Using trino connection "model.iceberg_project.events_streaming"
[0m13:21:56.630763 [debug] [Thread-1  ]: On model.iceberg_project.events_streaming: -- back compat for old kwarg name
  
  
        
            
            
        

        

        merge into "iceberg"."default"."events_streaming" as DBT_INTERNAL_DEST
            using "iceberg"."default"."events_streaming__dbt_tmp" as DBT_INTERNAL_SOURCE
            on (
                DBT_INTERNAL_SOURCE.id = DBT_INTERNAL_DEST.id
            )

        
        when matched then update set
            "id" = DBT_INTERNAL_SOURCE."id","name" = DBT_INTERNAL_SOURCE."name","created_at" = DBT_INTERNAL_SOURCE."created_at","_partition_id" = DBT_INTERNAL_SOURCE."_partition_id","_partition_offset" = DBT_INTERNAL_SOURCE."_partition_offset","processed_at" = DBT_INTERNAL_SOURCE."processed_at"
        

        when not matched then insert
            ("id", "name", "created_at", "_partition_id", "_partition_offset", "processed_at")
        values
            (DBT_INTERNAL_SOURCE."id", DBT_INTERNAL_SOURCE."name", DBT_INTERNAL_SOURCE."created_at", DBT_INTERNAL_SOURCE."_partition_id", DBT_INTERNAL_SOURCE."_partition_offset", DBT_INTERNAL_SOURCE."processed_at")
/* dbt: dev */
[0m13:21:57.158289 [debug] [Thread-1  ]: SQL status: MERGE (4 rows) in 0.527 seconds
[0m13:21:57.165574 [debug] [Thread-1  ]: Applying DROP to: "iceberg"."default"."events_streaming__dbt_tmp"
[0m13:21:57.166882 [debug] [Thread-1  ]: Using trino connection "model.iceberg_project.events_streaming"
[0m13:21:57.167134 [debug] [Thread-1  ]: On model.iceberg_project.events_streaming: drop view if exists "iceberg"."default"."events_streaming__dbt_tmp"
/* dbt: dev */
[0m13:21:57.239346 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.072 seconds
[0m13:21:57.251948 [debug] [Thread-1  ]: On model.iceberg_project.events_streaming: ROLLBACK
[0m13:21:57.252290 [debug] [Thread-1  ]: On model.iceberg_project.events_streaming: Close
[0m13:21:57.253591 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9a7d3066-c132-4923-923a-d871d1424563', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048efa30>]}
[0m13:21:57.254079 [info ] [Thread-1  ]: 1 of 1 OK created sql incremental model default.events_streaming ............... [[32mMERGE (4 rows)[0m in 1.28s]
[0m13:21:57.254464 [debug] [Thread-1  ]: Finished running node model.iceberg_project.events_streaming
[0m13:21:57.255172 [debug] [MainThread]: On master: COMMIT
[0m13:21:57.255435 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:21:57.255621 [debug] [MainThread]: Connection 'model.iceberg_project.events_streaming' was properly closed.
[0m13:21:57.255811 [info ] [MainThread]: 
[0m13:21:57.256017 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 1.68 seconds (1.68s).
[0m13:21:57.256409 [debug] [MainThread]: Command end result
[0m13:21:57.272058 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/target/manifest.json
[0m13:21:57.273109 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/target/semantic_manifest.json
[0m13:21:57.277359 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/ankurchopra/repo_projects/projects/trino_iceberg_dbt_pipeline/dbt/iceberg_project/target/run_results.json
[0m13:21:57.277573 [info ] [MainThread]: 
[0m13:21:57.277824 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:21:57.278017 [info ] [MainThread]: 
[0m13:21:57.278213 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:21:57.279511 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.2674685, "process_in_blocks": "0", "process_kernel_time": 0.189064, "process_mem_max_rss": "120930304", "process_out_blocks": "0", "process_user_time": 1.445367}
[0m13:21:57.280033 [debug] [MainThread]: Command `dbt run` succeeded at 13:21:57.279897 after 2.27 seconds
[0m13:21:57.280450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103775640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045d0880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120002ee0>]}
[0m13:21:57.280795 [debug] [MainThread]: Flushing usage events
[0m13:21:57.457625 [debug] [MainThread]: An error was encountered while trying to flush usage events
